

<script type="text/tmpl" id="optionTmplReview">
					<option data-code="{{id}}" data-value="{{name}}">{{name}}</option>
</script>
<script type="text/tmpl" id="cityTmplReview">
					<option data-code="{{code}}" data-father="{{father}}" >{{name}}</option>
</script>
<script type="text/tmpl" id="bankTmpl">
	<option data-code="{{bankcode}}" data-shortcode="{{shortcode}}" data-value="{{showname}}" value="{{bankcode}}">{{showname}}</option>
</script>


<div class="container-fluid">
    <form class="form-horizontal row-border" method="post" role="form" id="customer-mpos-form-update">
        <input type="hidden" name="customer.merAuto" value="1">
        <input type="hidden" name="taskId" id="current_Id">
        <!--{{!第一个widget box 商户基本信息，注：此类为handlebars特有注释，勿动}}-->
        <div class="widget box">
            <div class="widget-header">
                <h4><i class="icon-role-list-small"></i>
                    商户基本信息
                </h4>
            </div>

            <div class="widget-content">
                <div class="row">


                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">所属代理商<span class="required">*</span></label>

                            <div class="col-md-8">
                                <div class="input-group">
                                    <input type="text" class="form-control" id="M_update_parentAgentName" name="customer.agentName" readonly>
                                    <input type="hidden" class="form-control" id="parentAgentId" name="customer.agentId">
                                   <!-- <span class="input-group-addon btn bg-green" id="M_update_serachAgent_Btn">
                                        <span class="glyphicon glyphicon-search"></span>
                                    </span>-->
                                    <span class="input-group-addon btn bg-green" style="cursor: not-allowed;">
                                        <span class="glyphicon glyphicon-search"></span>
                                    </span>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">商户名称<span
                                class="required">*</span></label>

                            <div class="col-md-8">
                                <input type="text" class="form-control" name="customer.mercName">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">商户简称<span
                                class="required">*</span></label>

                            <div class="col-md-8">
                                <input type="text" class="form-control" name="customer.mercNameShort">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!--{{!第二个widget box 商户附加信息}}-->

        <div class="widget box">
            <div class="widget-header">
                <h4><i class="icon-role-list-small"></i>
                    商户附加信息
                </h4>
            </div>
            <div class="widget-content" style="padding-top:15px;">
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">商户所属行业<span class="required">*</span></label>

                            <div class="col-md-8">
                                <select name="customer.industry" id="M_update_AgentTop" class="form-control required">

                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">商户类别(MCC)<span class="required">*</span></label>
                            <div class="col-md-8">
                                <select name="customer.mcc" id="M_update_AgentSecond" class="form-control required">

                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="col-md-2 control-label">商户所属地址<span class="required">*</span></label>
                            <div class="col-md-10">
                                <input type="text" name="customer.address" class="form-control" >
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-md-4 control-label">商户营业执照号<span class="required">*</span></label>

                            <div class="col-md-8">
                                <input type="text" name="customer.businessLicense" class="form-control">
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-md-4 control-label">法人姓名<span class="required">*</span></label>

                            <div class="col-md-8">
                                <input type="text" name="customer.legalName" class="form-control" maxlength="20">
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-md-4 control-label">法人手机号<span class="required">*</span></label>

                            <div class="col-md-8">
                                <input type="text" name="customer.mobile" class="form-control">
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-md-4 control-label">身份证号码<span class="required">*</span></label>

                            <div class="col-md-8">
                                <input type="text" name="customer.idCard" class="form-control">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row hideLoop">
                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">商户经营地址<span
                                class="required">*</span></label>
                            <div class="col-md-8">
                                <select name="customer.peovinceId" id="M_update_province" class="form-control required">

                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-md-1 control-label"></label>
                            <div class="col-md-11">
                                <select name="customer.cityId" id="M_update_city" class="form-control required">
                                    <option value="0">--请选择--</option>
                                </select>
                            </div>
                        </div>
                    </div>


                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-md-1 control-label"></label>
                            <div class="col-md-11">
                                <select name="customer.areaCode" id="M_update_area" class="form-control required">
                                    <option value="0">--请选择--</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-md-1 control-label"></label>
                            <div class="col-md-11">
                                <input type="text" name="customer.businessAddress" class="form-control">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">

                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">结算开户行名称<span
                                class="required">*</span></label>

                            <div class="col-md-8">
                                <select id="M_bankTop_selectbankId" class="form-control required" name="customer.bankId"></select>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-md-4 control-label">开户支行名称<span class="required">*</span></label>

                            <div class="col-md-8">
                                <div class="input-group">
                                    <input type="text" id="M_update_branchBank_content" name="customer.branchbankName"
                                           class="form-control required" readonly/>
                                    <input type="hidden" id="merchantNewBranchbankId" name="customer.branchbankId"
                                           class="form-control"/>
                                                    <span class="input-group-addon bg-green btn" data-toggle="modal"
                                                          id="M_branchBank_Btn"><span
                                                            class="glyphicon glyphicon-search"></span></span>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <div class="row">

                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">结算账户名称<span
                                class="required">*</span></label>
                            <div class="col-md-8">
                                <input type="text" name="customer.accountName" class="form-control">
                            </div>
                        </div>
                    </div>


                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">结算账户账号<span
                                class="required">*</span></label>
                            <div class="col-md-8">
                                <input type="text" name="customer.accountNo" class="form-control">
                            </div>
                        </div>
                    </div>

                </div>

                <div class="row">
                    <div class="col-md-1">
                        商户资质附件
                    </div>
                    <div class="col-md-2">
                        <div class="upImgs" data-showmodal="M_update_review-showImg-madal">
                            <div class="main-div">
                                <a id="nUpdate-acc-del-1" class="del-btu del-normal" href="javascript:void(0);"></a>
                                <a id="nUpdate-acc-show-1" class="show-btu show-normal" href="javascript:void(0);"></a>
                                <div>
                                    <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image" style="height: 154px !important;" />
                                </div>
                                <input type="file" id="nUpdate-upload-file-1"  class="file image-input">
                                <input type="button" id="nUpdate-acc-upload-1" class="showbtu" value="上传">
                                <input type="button" id="nUpdate-acc-download-1" class="downloadbtn" value="下载">
                                <input type="hidden" name="imgs[0].type" value="1">
                                <input type="hidden" name="imgs[0].url" class="fileUrl" value="">
                                <div  style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;" >
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>

                            <span class="certificate-picture">营业执照</span>
                        </div>
                    </div>
                    <div class="col-md-1"></div>
                    <div class="col-md-2">
                        <div class="upImgs" data-showmodal="M_update_review-showImg-madal">
                            <div class="main-div">
                                <a id="nUpdate-acc-del-2" class="del-btu del-normal" href="javascript:void(0);"></a>
                                <a id="nUpdate-acc-show-2" class="show-btu show-normal" href="javascript:void(0);"></a>
                                <div>
                                    <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image" style="height: 154px !important;" />
                                </div>
                                <input type="file" id="nUpdate-upload-file-2"  class="file image-input">
                                <input type="button" id="nUpdate-acc-upload-2" class="showbtu" value="上传">
                                <input type="button" id="nUpdate-acc-download-2" class="downloadbtn" value="下载">
                                <input type="hidden" name="imgs[1].type" value="2">
                                <input type="hidden" name="imgs[1].url" class="fileUrl" value="">
                                <div  style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;" >
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <span class="certificate-picture">税务登记证</span>
                        </div>
                    </div>
                    <div class="col-md-1"></div>
                    <div class="col-md-2">
                        <div class="upImgs" data-showmodal="M_update_review-showImg-madal">
                            <div class="main-div">
                                <a id="nUpdate-acc-del-3" class="del-btu del-normal" href="javascript:void(0);"></a>
                                <a id="nUpdate-acc-show-3" class="show-btu show-normal" href="javascript:void(0);"></a>
                                <div>
                                    <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image" style="height: 154px !important;" />
                                </div>
                                <input type="file" id="nUpdate-upload-file-3"  class="file image-input">
                                <input type="button" id="nUpdate-acc-upload-3" class="showbtu" value="上传">
                                <input type="button" id="nUpdate-acc-download-3" class="downloadbtn" value="下载">
                                <input type="hidden" name="imgs[2].type" value="3">
                                <input type="hidden" name="imgs[2].url" class="fileUrl" value="">
                                <div  style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;" >
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <span class="certificate-picture">银行卡正面</span>
                        </div>
                    </div>
                    <div class="col-md-1"></div>
                    <div class="col-md-2">
                        <div class="upImgs" data-showmodal="M_update_review-showImg-madal">
                            <div class="main-div">
                                <a id="nUpdate-acc-del-4" class="del-btu del-normal" href="javascript:void(0);"></a>
                                <a id="nUpdate-acc-show-4" class="show-btu show-normal" href="javascript:void(0);"></a>
                                <div>
                                    <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image" style="height: 154px !important;" />
                                </div>
                                <input type="file" id="nUpdate-upload-file-4"  class="file image-input">
                                <input type="button" id="nUpdate-acc-upload-4" class="showbtu" value="上传">
                                <input type="button" id="nUpdate-acc-download-4" class="downloadbtn" value="下载">
                                <input type="hidden" name="imgs[3].type" value="4">
                                <input type="hidden" name="imgs[3].url" class="fileUrl" value="">
                                <div  style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;" >
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <span class="certificate-picture">组织机构代码证</span>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-1">
                    </div>
                    <div class="col-md-2">
                        <div class="upImgs" data-showmodal="M_update_review-showImg-madal">
                            <div class="main-div">
                                <a id="nUpdate-acc-del-5" class="del-btu del-normal" href="javascript:void(0);"></a>
                                <a id="nUpdate-acc-show-5" class="show-btu show-normal" href="javascript:void(0);"></a>
                                <div>
                                    <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image" style="height: 154px !important;" />
                                </div>
                                <input type="file" id="nUpdate-upload-file-5"  class="file image-input">
                                <input type="button" id="nUpdate-acc-upload-5" class="showbtu" value="上传">
                                <input type="button" id="nUpdate-acc-download-5" class="downloadbtn" value="下载">
                                <input type="hidden" name="imgs[4].type" value="5">
                                <input type="hidden" name="imgs[4].url" class="fileUrl" value="">
                                <div  style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;" >
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <span class="certificate-picture">法人证件正面照</span>
                        </div>


                    </div>
                    <div class="col-md-1"></div>
                    <div class="col-md-2">
                        <div class="upImgs" data-showmodal="M_update_review-showImg-madal">
                            <div class="main-div">
                                <a id="nUpdate-acc-del-6" class="del-btu del-normal" href="javascript:void(0);"></a>
                                <a id="nUpdate-acc-show-6" class="show-btu show-normal" href="javascript:void(0);"></a>
                                <div>
                                    <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image" style="height: 154px !important;" />
                                </div>
                                <input type="file" id="nUpdate-upload-file-6"  class="file image-input">
                                <input type="button" id="nUpdate-acc-upload-6" class="showbtu" value="上传">
                                <input type="button" id="nUpdate-acc-download-6" class="downloadbtn" value="下载">
                                <input type="hidden" name="imgs[5].type" value="6">
                                <input type="hidden" name="imgs[5].url" class="fileUrl" value="">
                                <div  style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;" >
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <span class="certificate-picture">法人证件背面照</span>
                        </div>
                    </div>
                    <div class="col-md-1"></div>
                    <div class="col-md-2">
                        <div class="upImgs" data-showmodal="M_update_review-showImg-madal">
                            <div class="main-div">
                                <a id="nUpdate-acc-del-7" class="del-btu del-normal" href="javascript:void(0);"></a>
                                <a id="nUpdate-acc-show-7" class="show-btu show-normal" href="javascript:void(0);"></a>
                                <div>
                                    <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image" style="height: 154px !important;" />
                                </div>
                                <input type="file" id="nUpdate-upload-file-7"  class="file image-input">
                                <input type="button" id="nUpdate-acc-upload-7" class="showbtu" value="上传">
                                <input type="button" id="nUpdate-acc-download-7" class="downloadbtn" value="下载">
                                <input type="hidden" name="imgs[6].type" value="7">
                                <input type="hidden" name="imgs[6].url" class="fileUrl" value="">
                                <div  style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;" >
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <span class="certificate-picture">法人手持照片或场地照片</span>
                        </div>
                    </div>
                    <div class="col-md-1"></div>
                    <div class="col-md-2">
                        <div class="upImgs" data-showmodal="M_update_review-showImg-madal">
                            <div class="main-div">
                                <a id="nUpdate-acc-del-8" class="del-btu del-normal" href="javascript:void(0);"></a>
                                <a id="nUpdate-acc-show-8" class="show-btu show-normal" href="javascript:void(0);"></a>
                                <div>
                                    <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image" style="height: 154px !important;" />
                                </div>
                                <input type="file" id="nUpdate-upload-file-8"  class="file image-input">
                                <input type="button" id="nUpdate-acc-upload-8" class="showbtu" value="上传">
                                <input type="button" id="nUpdate-acc-download-8" class="downloadbtn" value="下载">
                                <input type="hidden" name="imgs[7].type" value="8">
                                <input type="hidden" name="imgs[7].url" class="fileUrl" value="">
                                <div  style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;" >
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <span class="certificate-picture">协议</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!--{{!第三个widget box 刷卡成本信息}}-->

        <div class="widget box">
            <div class="widget-header">
                <h4><i class="icon-role-list-small"></i>
                    刷卡成本信息
                </h4>
            </div>

            <div class="widget-content">
                <div class="row">

                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">借记卡手续费<span
                                class="required">*</span></label>

                            <div class="col-md-8">
                                <div class="input-group">
                                    <!--{{#if swingCardDebitRate}}
                                    <input type="text" class="form-control" name="customer.swingCardDebitRate"
                                           placeholder="{{swingCardDebitRate}}">
                                    {{else}}-->
                                    <input type="text" class="form-control" name="customer.swingCardDebitRate">
                                    <!--{{/if}}-->
                                    <span class="input-group-addon">%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">贷记卡手续费<span
                                class="required">*</span></label>

                            <div class="col-md-8">
                                <div class="input-group">
                                    <!-- {{#if swingCardCreditRate}}
                                     <input type="text" class="form-control" name="customer.swingCardCreditRate"
                                            placeholder="{{swingCardCreditRate}}">
                                     {{else}}-->
                                    <input type="text" class="form-control" name="customer.swingCardCreditRate">
                                    <!--{{/if}}-->
                                    <span class="input-group-addon">%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">交易结算手续费<span
                                class="required">*</span></label>

                            <div class="col-md-8">
                                <div class="input-group">
                                    <!-- {{#if swingCardSettleFee}}
                                     <input type="text" class="form-control" name="customer.swingCardSettleFee"
                                            placeholder="{{swingCardSettleFee}}">
                                     {{else}}-->
                                    <input type="text" class="form-control" name="customer.swingCardSettleFee">
                                    <!--{{/if}}-->
                                    <span class="input-group-addon">元</span>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
        </div>
        <!--{{!第四个widget box 无卡成本信息（借贷记一致）}}-->

        <div class="widget box">
            <div class="widget-header">
                <h4><i class="icon-role-list-small"></i>
                    无卡成本信息（借贷记一致）
                </h4>
            </div>

            <div class="widget-content">
                <div class="row">

                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-md-4 control-label">无卡手续费<span class="required">*</span></label>

                            <div class="col-md-8">
                                <div class="input-group">
                                    <!--{{#if nonCardCreditRate}}
                                    <input type="text" class="form-control noCard_One" name="customer.nonCardCreditRate" placeholder="{{nonCardCreditRate}}">
                                    {{else}}-->
                                    <input type="text" class="form-control noCard_One" name="customer.nonCardCreditRate">
                                    <!--{{/if}}-->
                                    <span class="input-group-addon">%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!--{{!第二个无卡手续费，已被隐藏}}-->
                    <div class="col-md-3 hide">
                        <div class="form-group">
                            <label class="col-md-4 control-label">无卡手续费2<span class="required">*</span></label>

                            <div class="col-md-8">
                                <div class="input-group">
                                    <!--{{#if nonCardDebitRate}}
                                    <input type="text" class="form-control noCard_Copy" name="customer.nonCardDebitRate"
                                           placeholder="{{nonCardDebitRate}}">
                                    {{else}}-->
                                    <input type="text" class="form-control noCard_Copy" name="customer.nonCardDebitRate">
                                    <!--{{/if}}-->
                                    <span class="input-group-addon">%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--{{!第五个widget box 传统POS成本信息（借记卡封顶费率及成本与手刷相同）}}-->

        <div class="widget box">
            <div class="widget-header">
                <h4><i class="icon-role-list-small"></i>
                    传统POS成本信息（借记卡封顶费率及成本与手刷相同）
                </h4>
            </div>

            <div class="widget-content">
                <div class="row">


                    <div class="col-md-6 col-lg-3">
                        <div class="form-group">
                            <label class="col-md-4 control-label">借记卡手续费<span class="required">*</span></label>
                            <div class="col-md-8">
                                <div class="input-group">
                                    <!--  {{#if posDebitRate}}
                                      <input type="text" name="customer.posDebitRate" class="form-control"
                                             placeholder="{{posDebitRate}}">
                                      {{else}}-->
                                    <input type="text" name="customer.posDebitRate" class="form-control">
                                    <!--{{/if}}-->
                                    <span class="input-group-addon">%</span></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-3">
                        <div class="form-group">
                            <label class="col-md-4 control-label">贷记卡手续费<span class="required">*</span></label>
                            <div class="col-md-8">
                                <div class="input-group">
                                    <!-- {{#if posCreditRate}}
                                     <input type="text" class="form-control" name="customer.posCreditRate"
                                            placeholder="{{posCreditRate}}">
                                     {{else}}-->
                                    <input type="text" class="form-control" name="customer.posCreditRate">
                                    <!--{{/if}}-->
                                    <span class="input-group-addon">%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group"><label class="col-md-4 control-label">交易结算手续费<span
                                class="required">*</span></label>

                            <div class="col-md-8">
                                <div class="input-group">
                                    <!--{{#if posSettleFee}}
                                    <input type="text" class="form-control" name="customer.posSettleFee"
                                           placeholder="{{posSettleFee}}">
                                    {{else}}-->
                                    <input type="text" class="form-control" name="customer.posSettleFee">
                                    <!--{{/if}}-->
                                    <span class="input-group-addon">元</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--{{!第六个widget box 扫码成本信息（借贷记一致）}}-->

        <div class="widget box">
            <div class="widget-header">
                <h4><i class="icon-role-list-small"></i>
                    扫码成本信息（借贷记一致）
                </h4>
            </div>

            <div class="widget-content">
                <div class="row">
                    <div class="col-md-6 col-lg-3">
                        <div class="form-group">
                            <label class="col-md-4 control-label">微信手续费<span class="required">*</span></label>
                            <div class="col-md-8">
                                <div class="input-group">
                                    <!--{{#if scanCodeWxRate}}-->
                                    <!--<input type="text" name="customer.scanCodeWxRate" class="form-control"-->
                                    <!--placeholder="{{scanCodeWxRate}}">-->
                                    <!--{{else}}-->
                                    <input type="text" name="customer.scanCodeWxRate" class="form-control">
                                    <!--{{/if}}-->
                                    <span class="input-group-addon">%</span></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <div class="form-group">
                            <label class="col-md-4 control-label">支付宝手续费<span class="required">*</span></label>
                            <div class="col-md-8">
                                <div class="input-group">
                                    <!-- {{#if scanCodeZfbRate}}
                                     <input type="text" name="customer.scanCodeZfbRate" class="form-control"
                                            placeholder="{{scanCodeZfbRate}}">
                                     {{else}}-->
                                    <input type="text" name="customer.scanCodeZfbRate" class="form-control">
                                    <!--{{/if}}-->

                                    <span class="input-group-addon">%</span></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-3">
                        <div class="form-group">
                            <label class="col-md-4 control-label">银联扫码手续费<span class="required">*</span></label>
                            <div class="col-md-8">
                                <div class="input-group">
                                    <!-- {{#if scanCodeYlRate}}
                                     <input type="text" class="form-control" name="customer.scanCodeYlRate"
                                            placeholder="{{scanCodeYlRate}}">

                                     {{else}}-->
                                    <input type="text" class="form-control" name="customer.scanCodeYlRate">
                                    <!--{{/if}}-->
                                    <span class="input-group-addon">%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--{{!最后一个weideg box table表格 不做表单验证}}-->


        <div class="widget box">
            <div class="widget-header">
                <div class="col-md-4 no-padding"><h4><i class="icon-list"></i>手机商户设备表</h4></div>
                <div class="col-md-8 no-padding">
                    <div class="toolbar no-padding">
                        <input type="button" class="btn btn-default pull-right Nor-delPhone sh_btn"
                               value="删&nbsp;&nbsp;除" style="background:#1e6cb4;color:white;">
                        <input type="button" class="btn btn-success pull-right add-device-btn sh_btn"
                               data-toggle="modal" id="normal_update_addPhone" value="增&nbsp;&nbsp;加"
                               style="background:#00a4de;color:white;">
                    </div>
                </div>
            </div>
            <div class="widget-content no-padding">

                <table data-toggle="table" id="M_update_edit-device-list"
                       class="table table-striped table-checkable table-hover table-bordered"
                       data-query-params="deviceListQuery"
                       data-url="/customer/loadCustomerDevice.json"
                       data-method="post">

                    <thead>
                    <tr>
                        <th data-field="" data-align="center"
                            data-checkbox="true"><input type="checkbox"
                                                        data-toggle="checkbox" class="uniform"/>
                        </th>
                        <th data-field="deviceNo" data-align="left">机身号</th>
                        <th data-field="createTime" data-align="left">创建时间</th>
                        <th data-field="isFirst" data-align="left" data-formatter="firstSelectUpdate">首选项</th>
                        <th data-field="typeName" data-align="left">设备类型</th>
                        <th data-field="modeName" data-align="left">设备名称</th>
                    </tr>
                    </thead>
                </table>

            </div>
        </div>

        <div class="widget box">
            <div class="widget-header">
                <div class="col-md-4 no-padding"><h4><i class="icon-list"></i>商户二维码</h4></div>
                <div class="col-md-8 no-padding">
                    <div class="toolbar no-padding">
                        <input type="button" class="btn btn-default pull-right  sh_btn"
                               value="保&nbsp;&nbsp;存" style="background:green;color:white;" id="merchant_imgs_code_save">
                        <input type="button" class="btn btn-default pull-right  sh_btn"
                               value="删&nbsp;&nbsp;除" style="background:#1e6cb4;color:white;" id="merchant_imgs_code_del">
                        <input type="button" class="btn btn-success pull-right  sh_btn"
                               data-toggle="modal" id="merchant_imgs_code" value="增&nbsp;&nbsp;加"
                               style="background:#00a4de;color:white;">
                    </div>
                </div>
            </div>
            <div class="widget-content no-padding">
                <table data-toggle="table" id="merchant_imgs_code_table"
                       class="table table-striped table-checkable table-hover table-bordered"
                       data-query-params="merchant_seach_data"
                       data-url="/qrcode/customer/query"
                       data-method="post">
                    <thead>
                    <tr>
                        <th data-field="" data-checkbox="true"></th>
                        <th data-field="qrCodeId" data-align="left">二维码ID</th>
                        <th data-field="agentNo" data-align="left">所属代理商ID</th>
                        <th data-field="" data-align="left" data-formatter="mech_code_some">操作</th>
                    </tr>
                    </thead>
                </table>

            </div>
        </div>

        <!--初审的审核意见-->
        <div class="row">
            <div class="col-md-12">
                <div class="widget box">
                    <div class="widget-header">
                        <h4>
                            <i class="icon-form"></i>运营意见
                        </h4>
                    </div>
                    <div class="widget-content">
                        <div class="row">


                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="col-md-4 control-label">商户状态<span
                                            class="required">*</span>
                                    </label>
                                    <div class="col-md-8">
                                        <select name="customer.opstate" class="form-control">
                                            <option value="1">开通</option>
                                            <option value="0">关闭</option>
                                            <option value="2">冻结</option>
                                            <option value="3">黑名单</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                        <div class="col-md-3">
                            <div class="form-group">
                                <label class="col-md-4 control-label">商户渠道<span
                                        class="required">*</span>
                                </label>
                                <div class="col-md-8">
                                    <select name="customer.channel" class="form-control">
                                        <option value="1">大pos</option>
                                        <option value="2">M-pos</option>
                                        <option value="0">无卡</option>
                                        <option value="3">智能-pos</option>
                                    </select>
                                </div>
                            </div>
                         </div>

                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="col-md-4 control-label">商户风险等级<span
                                            class="required">*</span>
                                    </label>
                                    <div class="col-md-8">
                                        <select name="customer.customerLevel" class="form-control" id="M_update_level_risk">

                                        </select>
                                    </div>
                                </div>
                            </div>
                    </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-md-1 control-label">商户通道</label>
                                    <input type="hidden" name="instCode" id="checkBoxVal">
                                    <div class="col-md-11" id="N_update_custom_tongdao">

                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <input type="hidden" name="customer.opstate" value="1" />
                            <!--                                     <div class="col-md-3">
                                <div class="form-group">
                                    <label class="col-md-4 control-label">商户状态<span class="required">*</span> </label>
                                    <div class="col-md-8">
                                        <select name="customer.opstate" class="form-control">
                                            <option value="1">开通</option>
                                            <option value="0">关闭</option>
                                            <option value="2">冻结</option>
                                            <option value="3">黑名单</option>
                                        </select>
                                    </div>
                                </div>
                            </div> -->

                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-md-1 control-label">审核意见</label>
                                    <div class="col-md-11">
                                        <input type="hidden" id="reviewMercNo" name="customer.mercNo"
                                               class="form-control required url">
												<textarea class="form-control required url"
                                                          name="review.advice" rows="6" style="resize: none;"
                                                          maxlength="200"></textarea>
                                    </div>
                                </div>
                            </div>

                        </div>


                        <div class="clearfix"></div>
                        <div class="form-actions">
                            <input type="submit" value="确认" class="btn btn-success pull-right">
                            <input type="button" value="取消" class="btn btn-default pull-right" id="Mposcustomer_update_cancel_btn">
                        </div>

                    </div>
                </div>

            </div>
        </div>



        <!-- {{!底部的提交按钮}}-->
     <!--   <div class="row">
            <ul class="pager">
                <li>
                    <input id="Mposcustomer_update_cancel_btn" type="button" class="btn btn-primary sh_btn" value="取消">
                    <input type="submit" class="btn btn-primary sh_btn" value="确认">
                </li>
            </ul>
        </div>-->
    </form>
</div>















<!-- 图片预览模态框 -->
<div class="modal fade" id="M_update_review-showImg-madal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content" >
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title align-center imgTitle"></h4>
            </div>
            <div class="modal-body">
                <div class="modal-pic-review">
                    <img src="" width="100%" height="100%" style="width: 500px;height: 500px;">
                    <input type="button" class="rotateImg" placeholder="顺时针旋转90°" />
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关&nbsp;&nbsp;闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<div class="modal fade" id="M_update_device-edit-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">过滤条件</h4>
            </div>
            <div class="modal-body">
                <div id="" class="form-horizontal">
                    <div class="row">
                        <div class="col-md-9">
                            <div class="form-group">
                                <label class="col-md-2 control-label">机身号</label>

                                <div class="col-md-6">
                                    <input type="text" name="bodyNoStart" class="form-control">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-success btn-query pull-right">查询</button>
                        </div>
                    </div>
                </div>

                <table data-toggle="table" id="M_update_cusEditDeviceAddTable"
                       class="table table-striped table-checkable table-hover table-bordered"
                       data-query-params="deviceQuery"
                       data-url="/device/storage/unbind/list.json" data-pagination="true"
                       data-side-pagination="server" data-page-size="5"
                       data-pagination-first-text="First"
                       data-pagination-pre-text="上一页" data-pagination-next-text="下一页"
                       data-pagination-loop="false" data-page-list=[5]
                       data-pagination-last-text="Last" data-method="post">

                    <thead>
                    <tr>
                        <th data-field="" data-radio="true"></th>
                        <th data-field="deviceNo">机身号</th>
                        <th data-field="typeName">设备类型</th>
                        <th data-field="modeName">设备名称</th>
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="modal-footer">
                <div class="form-horizontal">
                    <div class="row hide-default">
                        <div class="col-lg-12">
                            <div class="form-group">
                                <label class="col-md-3 control-label">是否是首选项 </label>

                                <div class="col-md-6">
                                    <select id="isFirst" name="isFirst" class="form-control">
                                        <option value="0">否</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-default" data-dismiss="modal">关&nbsp;&nbsp;闭</button>
                <button type="button" class="btn btn-success confirm-btn">确&nbsp;&nbsp;定</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div><!-- /.modal -->
<!-- 新增模态框结束 -->

<!-- 删除手机商户设备表模态框 -->
<div class="modal fade" id="Nor-del-PhoneModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">手机商户设备表</h4>
            </div>
            <div class="modal-body">
                <p class="align-center">
                    确定删除选中的设备吗？
                </p>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关&nbsp;&nbsp;闭</button>
                <button type="button" id="Nor-del-Confirm" class="btn btn-success">确&nbsp;&nbsp;定</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>

<!--设置所属代理商-->
<!--模态框-查询父代理商 start-->
<div class="modal fade" id="M_update" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">Close</span></button>
                <h4 class="modal-title">查询父代理商</h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" id="addFactoryCus"
                      novalidate="novalidate">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-md-4 control-label">父代理商</label>
                                <div class="col-md-8"><input type="text" id="fagent" class="form-control" maxlength="50"></div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <!--<button  class="btn btn-success pull-right" id="fagentQuery">查询</button>-->
                        </div>
                    </div>
                    <div class="clearfix"></div>
                </form>

                <table class="table table-striped table-hover table-bordered" id="fagentTable"
                       data-toggle="table" data-query-params="agentAddParams"
                       data-url="../agent/queryNoAndNameList" data-pagination="true"
                       data-side-pagination="server" data-page-size="5"
                       data-pagination-first-text="First" data-page-list="[5]"
                       data-pagination-pre-text="上一页" data-pagination-next-text="下一页" data-pagination-loop="false"
                       data-pagination-loop="false"
                       data-pagination-last-text="Last" data-method="post">
                    <thead>
                    <tr>
                        <th data-field="" data-radio="true"></th>
                        <th data-field="agentNo" data-align="left">代理商编号</th>
                        <th data-field="name" data-align="left">代理商名称</th>
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" id="closeFagent">关&nbsp;&nbsp;闭</button>
                <button type="button" class="btn btn-success" id="M_update_sureFagent">确&nbsp;&nbsp;定</button>
            </div>
        </div>
    </div>
</div>
<!--模态框-查询父代理商 end-->

<!--弹出银行支行模态框-->
<div class="modal fade" id="M_branchBank_Modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">Close</span></button>
                <h4 class="modal-title">查询支行信息</h4>
            </div>
            <div class="modal-body">
                <div id="sbbg-query" class="form-horizontal">
                    <div class="row">
                        <div class="col-md-5">
                            <div class="form-group"><label class="col-md-4 control-label">支行编号</label>

                                <div class="col-md-8">
                                    <input type="text" name="branchbankcode" class="form-control"  maxlength="50">
                                </div>
                            </div>
                        </div>

                        <div class="col-md-5">
                            <div class="form-group"><label class="col-md-4 control-label">支行名称</label>

                                <div class="col-md-8">
                                    <input type="text" name="branchbankname" class="form-control"  maxlength="50"></div>
                            </div>
                        </div>

                        <div class="col-md-2">
                            <button class="btn btn-success bank-btn-query pull-right">查询</button>
                        </div>
                    </div>
                </div>
                <table data-toggle="table" id="N_updateBranchBank_Table"
                       class="table table-striped table-checkable table-hover table-bordered"
                       data-query-params="M_branchSelect_query"
                       data-url="/system/bank/bankBranchList.json" data-pagination="true"
                       data-side-pagination="server" data-page-size="5"
                       data-pagination-first-text="First" data-page-list=[5]
                       data-pagination-pre-text="上一页" data-pagination-next-text="下一页"
                       data-pagination-loop="false"
                       data-pagination-last-text="Last" data-method="post">
                    <thead>
                    <tr>
                        <th data-field="" data-radio="true"></th>
                        <th data-field="branchbankcode">支行编码</th>
                        <th data-field="branchbankname">支行名称</th>
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关&nbsp;&nbsp;闭</button>
                <button type="button" class="btn btn-success btn-confirm">确&nbsp;&nbsp;定</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<!--二维码模态框增加-->
<div class="modal fade" id="merchant_modal_img" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">过滤条件</h4>
            </div>
            <div class="modal-body">
                <div id="" class="form-horizontal">
                    <div class="row">
                        <div class="col-md-9">
                            <div class="form-group">
                                <label class="col-md-2 control-label">二维码ID</label>
                                <form id="serch_form_imgs">
                                    <div class="col-md-6">
                                        <input type="text" name="agentNo" class="form-control"  style="display: none">
                                        <input type="text" name="unbound" class="form-control" value="0" style="display: none">
                                        <input type="text" name="qrCodeNo" class="form-control" >
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-success btn-query pull-right" id="btn_sech_img">查询</button>
                        </div>
                    </div>
                </div>

                <table class="table table-striped table-hover table-bordered" id="agent_code_mercht"
                       data-toggle="table" data-query-params="agent_code_searh_mercht"
                       data-url="/qrcode/agent/paginate"  data-pagination="true"
                       data-side-pagination="server" data-page-size="5"
                       data-pagination-first-text="First"
                       data-pagination-pre-text="上一页" data-pagination-next-text="下一页" data-pagination-loop="false"
                       data-pagination-last-text="Last" data-method="post">

                    <thead>
                    <tr>
                        <th data-field="" data-checkbox="true"></th>
                        <th data-field="qrCodeId" data-align="left">二维码ID</th>
                        <th data-field="agentNo" data-align="left">所属代理商ID</th>
                        <!--<th data-field="" data-align="left" data-formatter="mech_code_some">操作</th>-->
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关&nbsp;&nbsp;闭</button>
                <button type="button" class="btn btn-success confirm-btn" id="btn_mechart_imgs">确&nbsp;&nbsp;定</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div><!-- /.modal -->
<!--=====================end==============================================================-->
<!--二维码删除-->
<div class="modal fade" id="mechart_btn_imgs" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog sm-modal">
        <div class="modal-content" style="text-align: center">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span></button>
                <h4 class="modal-title align-center">二维码删除</h4>
            </div>

            <div class="modal-body">
                <h4 id="imgs_id" style="display: none;"></h4>
                <span id="ig_mercNo" style="display: none;"></span>
                <span id="ig_qrCodeId" style="display: none;"></span>
                <h4>确定删除二维码</h4>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取&nbsp;&nbsp;消</button>
                <button type="button" class="btn btn-success confirm-btn" id="merchant_btn_sub">确&nbsp;&nbsp;定</button>
            </div>

        </div>
    </div>
</div>
<!--多个删除-->
<div class="modal fade" id="mechart_btn_imgs2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog sm-modal">
        <div class="modal-content" style="text-align: center">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span></button>
                <h4 class="modal-title align-center">二维码删除</h4>
            </div>

            <div class="modal-body">
                <h4>确定删除二维码</h4>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取&nbsp;&nbsp;消</button>
                <button type="button" class="btn btn-success confirm-btn" id="merchant_btn_sub2">确&nbsp;&nbsp;定</button>
            </div>

        </div>
    </div>
</div>

<!--二维码模态框-->
<div class="modal fade" id="me_img_uplod_updown" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog sm-modal">
        <div class="modal-content" style="text-align: center">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span></button>
                <h4 class="modal-title align-center">二维码下载</h4>
            </div>

            <div class="modal-body">
                <img src="" alt="" style="width: 207px;height: 207px;" id="me_mer_imgcode">
                <input type="text" id="me_key" style="display: none">;
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取&nbsp;&nbsp;消</button>
                <button type="button" class="btn btn-success confirm-btn" id="me_profit_btn_code">下&nbsp;&nbsp;载</button>
            </div>

        </div>
    </div>
</div>
<script type="text/javascript" src="js/oss/upLoadFileUI.js"></script><script>
var merchant_num=null;

    //获取当前页面的参数
    var review_args = UTIL.readUrlData({"currentUrl" : "merchant-Normalinfo-update.html"});
    var review_mercNo = review_args["mercNo"];
    var review_agentId = review_args["agentId"];
    merchant_num=review_args["mercNo"]
    $("#serch_form_imgs input[name='agentNo']").val(review_args["agentId"])

    var current_taskId=review_args["taskId"];

    var $form=$("#customer-mpos-form-update");

    var city_code=null;
    var area=null;
    var custom_Mcc=null;
    var custom_industry=null;//商户所属行业-top
    var custom_mcc=null;//商户所属行业mcc
    var bank_bankId=null;//结算开户行名称
    var bank_branchbankName=null;//开户支行名称
    var area2=null;
    var N_UpdateFather_dls=null;
    // 页面加载的时候先把城市和区填完整



    $.ajax({
        url: "/inst/allInst",
        method: 'get',
        success: function (res) {

            $.each(res,function(i,v){
                $("#N_update_custom_tongdao").append('<label class="radio-inline"><input type="checkbox" class="uniform" name="" value="'+res[i].instCode+'">'+res[i].instName+'</label>');
            })
        }
    });

    var normal_update_tongdao=$("#N_update_custom_tongdao").find("input[type='checkbox']");

    $.ajax({
        type:'get',
        url:"/customer/find/"+review_mercNo+".json",
        async: false,
        success:function(res){

            city_code=res.customer.peovinceId;
            area=res.customer.cityId;
            area2=res.customer.areaCode;
            custom_industry=res.customer.industry;
            custom_mcc=res.customer.mcc;
            bank_bankId=res.customer.bankId;
            bank_branchbankName=res.customer.branchbankName;
            N_UpdateFather_dls=res.customer.agentId;
            var n_update_checkbox=res.instCode;


            if(n_update_checkbox){
                var N_update_instCode_num=n_update_checkbox.split(",");
                $.each(normal_update_tongdao,function(k,v){
                    var _this=$(this);

                    $.each(N_update_instCode_num,function(i,v){
                        if(_this.attr("value")==N_update_instCode_num[i]){
                            _this.attr("checked", true);
                        }
                    })
                })
            }

        }
    });

    // 手机商户设备列表参数
    function deviceListQuery(argms) {
        argms.mercNo = review_mercNo || "";
        return argms;
    };

    var agent_up = null;
    //新增代理商身份识别
    $.ajax({
        url: "/agent/getAgentInfo/?agentNo="+N_UpdateFather_dls,
        method: 'get',
        async: false,
        success: function (res) {
            //获取全部代理商信息；
            $.each(res, function (i, n) {
                if (res[i] == null) {
                    res[i] = 0;
                }
            })
            //设置全局保存的数值；
            agent_up = res;
        }
    });


    //新增手机设备查询
    $("#M_update_device-edit-modal .btn-query").on("click", function (e) {
        e.preventDefault();
        $("#M_update_cusEditDeviceAddTable").bootstrapTable("selectPage", 1);
    });


    //手机商户设备表  ---首选项
    function firstSelectUpdate(index, row) {
        var firstSelectList = row.isFirst;
        if (firstSelectList == "0") {
            return "否"
        } else {
            return "是"
        }
    }

    //所属代理商弹框表请求参数
    function agentAddParams(argms){
        argms.agentNo = $("#fagent").val();
        return argms;
    };

    //银行支行模态窗口初始化数据
    function M_branchSelect_query(argms) {
        argms.bankcode = $("#M_bankTop_selectbankId option:selected").data('shortcode');
        argms.branchbankcode = $("#M_branchBank_Modal input[name='branchbankcode']").val().trim() || "";
        argms.branchbankname = $("#M_branchBank_Modal input[name='branchbankname']").val().trim() || "";
        return argms;
    };
    //父代理商确定事件
    $("#M_update_sureFagent").on('click',function(){
        var tempAgent = $("#fagentTable").bootstrapTable('getSelections');
        if(tempAgent.length > 0){

            tempAgent = tempAgent[0];
            /* $("#parentAgentName").find("input[name='parentAgentName']").val(tempAgent.name).focus();
             $("#parentAgentId").find("input[name='parentAgentId']").val(tempAgent.agentNo);*/

            $("#M_update_parentAgentName").val(tempAgent.name).focus();
            $("#parentAgentId").val(tempAgent.agentNo);
        }
        $("#M_update").modal("hide");
    })

    // 父代理商模态框中查询数据清空
    $("#M_update").on('hide.bs.modal', function() {
        $("#fagent").val("");
        $("#fagentTable").bootstrapTable("selectPage", 1);//清空选中项
    })

    //父代理商模态框关闭按钮
    $("#closeFagent").on('click',function(){
        $("#M_update").modal("hide");
    });
    //弹出银行支行模态框
    $('#M_branchBank_Btn').on('click', function () {
        $("#M_branchBank_Modal").modal("show");
    });




    //底部改变商户等级
    $.ajax({
        url: "/customer/level/all",
        dataType:"json",
        type:"get",
        success:function(res){
            var str="";
            $.each(res,function(k,v){

                str+='<option name="customerLevel" value='+res[k].level+'>'+res[k].level+'</option>';
            })
            $("#M_update_level_risk").append(str);
        }
    });




    // 手机商户设备新增列表参数
    function deviceQuery(argms) {
        argms.agentNo = review_agentId || "";
        argms.bodyNoStart = $("#M_update_device-edit-modal input[name='bodyNoStart']").val() || "";
        return argms;
    };

    $('[data-toggle="table"]').bootstrapTable();
    //点击增加弹出模态框
    $('#normal_update_addPhone').on('click', function () {
        $("#M_update_device-edit-modal").modal("show");
    });
    //点击弹出选者 所属代理商
    $('#M_update_serachAgent_Btn').on('click', function () {
        $("#M_update").modal("show");
    });

    $("#M_update_device-edit-modal .confirm-btn").on("click", function () {
        var manufacturer = $("#M_update_cusEditDeviceAddTable").bootstrapTable('getSelections');
        if (manufacturer.length > 0) {
            manufacturer = manufacturer[0];

            var deviceNo = manufacturer.deviceNo;
            var isFirst = $("#M_update_device-edit-modal #isFirst").val();
            var typeName = manufacturer.typeName;
            var modeName = manufacturer.modeName;

            //发送新增设备请求
            var deviceBean = {
                "customerId": review_mercNo,
                "deviceNo": deviceNo,
                "typeName": typeName,
                "modeName": modeName,
                "isFirst": isFirst

            };

            $.ajax({
                type: "post",
                dataType: "json",
                contentType: "application/json",
                url: "/customer/insert.json",
                data: JSON.stringify(deviceBean),
                success: function (res) {
                    if (res != null) {
                        //页面手机商户设备表刷新table
//                         UTIL.clickDisappearSwal("新增成功！");
                        $('#M_update_edit-device-list').bootstrapTable('refresh', {silent: true});
                        $("#M_update_cusEditDeviceAddTable").bootstrapTable("selectPage", 1);
//                          UTIL.clickDisappearSwal("新增成功！");
                    } else {
                        UTIL.clickDisappearSwal("新增失败！");
                    }
                }
            });
        }
        $("#M_update_device-edit-modal").modal("hide");
    });

    //单个删除
    $(".Nor-delPhone").on("click", function () {
        var del_device_list = $("#M_update_edit-device-list").bootstrapTable(
                "getSelections");

        var del_list_length = del_device_list.length;
        if (del_list_length < 1) {
            UTIL.clickDisappearSwal("没有选中所要删除的设备");

        } else {
            $("#Nor-del-PhoneModal").modal("show");
        }
    });


    // 批量删除设备
    $("#Nor-del-Confirm").click(
            function () {
                var deviceArray = [];
                var del_device_list = $("#M_update_edit-device-list").bootstrapTable(
                        "getSelections");

                for (var i in del_device_list) {
                    deviceArray.push(del_device_list[i].deviceNo);
                }

                //发送删除请请求
                $.ajax({
                    type: "post",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/customer/batchDelete/" + review_mercNo + ".json",
                    data: JSON.stringify(deviceArray),
                    success: function (res) {
                        if (res > 0) {
                            //重新加载设备列表
                            $('#M_update_edit-device-list').bootstrapTable('refresh', {silent: true});
                            $("#M_update_cusEditDeviceAddTable").bootstrapTable("selectPage", 1);
                            $("#Nor-del-PhoneModal").modal("hide");
                            UTIL.clickDisappearSwal("删除成功！");
                        } else {
                            UTIL.clickDisappearSwal("删除失败！");
                        }

                    }
                });

            });









    //---------------------------------------------------------


    function changeBank($that, success) {
        var shortcodeCode = $('option:selected', $that).data('shortcode').toString();

        $('#M_update_branchBank_content').val('');
        $('#merchantNewBranchbankId').val('');
    }
    //初始化开户总行名称列表
    $.ajax({
        url: "/system/bank/loadAllBank",
        method: 'post',
        success: function (res) {
            var $selectBankList = $form.find('select').filter(
                    function () {
                        return ($(this).attr('id') || '').toLowerCase()
                                        .indexOf('bankid') >= 0;
                    });
            $selectBankList.empty();
            $selectBankList.each(function (index) {
                for (var i = 0; i < res.length; i++) {
                    var str = $("#bankTmpl").html();
                    $(this).append(str.replace(/\{\{code\}\}/g, res[i].bankcode).replace(/\{\{bankcode\}\}/g, res[i].bankcode).replace(/\{\{shortcode\}\}/g, res[i].shortcode).replace(/\{\{showname\}\}/g, res[i].showname));
                }
                changeBank($(this));
                $(this).change(function () {
                    var $that = $(this);
                    changeBank($that);
                });
            });
        },
        error: function (xhr, textStatus, errorThrown) {
            alert("亲，初始化开户总行名称列表出错，请联系管理员！");
        }
    });


    // 初始化table
    $('[data-toggle="table"]').bootstrapTable();

    // 开户行模态框消失时校验状态更新
    $("#M_branchBank_Modal").on('hide.bs.modal', function () {
        $form.data('formValidation').updateStatus('boCustomer.branchbankName', 'NOT_VALIDATED', null);
    });


    //弹出银行支行模态框
    $('#M_branchBank_Btn').on('click', function () {
        $("#M_branchBank_Modal").modal("show");
    });

    //银行支行模态窗


    $("#M_branchBank_Modal").on('show.bs.modal', function () {
        //在银行支行显示的时候给予银行名字赋值；
        var bankName=$("#M_bankTop_selectbankId option:selected").text();
        $("#bankName").val(bankName);
        function M_branchSelect_query(argms) {
            argms.bankcode = $("#M_bankTop_selectbankId  option:selected").data('shortcode');
            argms.branchbankcode = $("#M_branchBank_Modal input[name='branchbankcode']").val().trim() || "";
            argms.branchbankname = $("#M_branchBank_Modal input[name='branchbankname']").val().trim() || "";
            return argms;
        };
        $("#N_updateBranchBank_Table").bootstrapTable("selectPage", 1);
    });


    $("#M_branchBank_Modal").on('hide.bs.modal', function () {
        $("#M_branchBank_Modal input[name='branchbankId']").val("");
        $("#M_branchBank_Modal input[name='branchbankName']").val("");
        $("#N_updateBranchBank_Table").bootstrapTable("selectPage", 1);
    });

    // 银行支行查询按钮点击事件
    var $sqdlsbhTableData =  $("#N_updateBranchBank_Table").bootstrapTable("getData");
    $("#M_branchBank_Modal .bank-btn-query").on("click", function (e) {
        e.preventDefault();
        if($sqdlsbhTableData.length === 0 ){
            var randomNum = parseInt(Math.random()*99999);
            var sqdlsbhTableRefreshUrl =  $("#N_updateBranchBank_Table").data("url") + "?" + randomNum;
            $("#N_updateBranchBank_Table").bootstrapTable("refresh", {
                url:sqdlsbhTableRefreshUrl
            });
            $sqdlsbhTableData =  $("#N_updateBranchBank_Table").bootstrapTable("getData");
        }
        else{
            $("#N_updateBranchBank_Table").bootstrapTable("selectPage", 1);
        }

    });

    //银行支行模态框中查询数据清空
    $("#M_branchBank_Modal").on('hide.bs.modal', function () {
        $("#M_branchBank_Modal input[name='branchbankcode']").val("");
        $("#M_branchBank_Modal input[name='branchbankname']").val("");
        $("#M_branchBank_Modal").bootstrapTable("selectPage", 1);
    });
    // 银行支行确认按钮点击事件
    $("#M_branchBank_Modal .btn-confirm").on("click", function () {
        var manufacturer = $("#N_updateBranchBank_Table").bootstrapTable('getSelections');
        if (manufacturer.length > 0) {
            manufacturer = manufacturer[0];
            $form.find("input[id='merchantNewBranchbankId']").val(manufacturer.branchbankcode);
            $form.find("input[id='M_update_branchBank_content']").val(manufacturer.branchbankname);
        }
        $("#M_branchBank_Modal").modal("hide");
    });

    //----------------------银行结束

    $("#M_bankTop_selectbankId").val(bank_bankId);
    $("#M_update_branchBank_content").val(bank_branchbankName);

    //----------------------------------------------------------------------

    //商户所属行业
    $.ajax({
        url:"/system/mcc/loadData/0",
        type:"get",
        async:false,
        dataType:"json",
        success:function(res){
            var str="";
            $.each(res,function(i,v){
                str+=('<option value ='+res[i].id+'>'+res[i].name+'</option>');
            })
            $("#M_update_AgentTop").empty();
            $("#M_update_AgentTop").append(str);
        }
    });
    $("#M_update_AgentTop").val(custom_industry);

    $.ajax({
        url:"/system/mcc/loadData/"+custom_industry,
        type:"get",
        async:false,
        dataType:"json",
        success:function(res){
            var str="";
            $.each(res,function(i,v){
                str+=('<option value ='+res[i].id+'>'+res[i].name+'</option>');
            })
            $("#M_update_AgentSecond").empty();
            $("#M_update_AgentSecond").append(str);
        }
    });
    $("#M_update_AgentSecond").val(custom_mcc);


    function changeHangye(t){
        $.ajax({
            url:"/system/mcc/loadData/"+t,
            type:"get",
            async:false,
            dataType:"json",
            success:function(res){
                var str="";
                $.each(res,function(i,v){
                    str+=('<option value ='+res[i].id+'>'+res[i].name+'</option>');
                })
                $("#M_update_AgentSecond").empty();
                $("#M_update_AgentSecond").append(str);
            }
        });
    }
    $("#M_update_AgentTop").change(function(){
        var cusHangye=$(this).find("option:selected").attr("value");
        changeHangye(cusHangye)
    });




    //页面加载默先加载省，三级联动start
    $.ajax({
        url: "/system/address/loadAllData/0/0",
        method: 'post',
        data:"{'type':0,'code':0}",
        success: function (res) {
            var op='';
            $.each(res,function (i,n){
                op=op+('<option value ='+res[i].code+'>'+res[i].name+'</option>')
            });

            $('#M_update_province').append(op);
            $('#M_update_province').val(city_code);
        },
        error: function (xhr, textStatus, errorThrown) {
            alert("亲，初始化省列表出错，请联系管理员！");
        }
    });


    $.ajax({
        url:'/system/address/loadAllData/'+1+'/'+city_code,
        method: 'post',
        data:"{'type':0,'code':0}",
        success: function (res) {
            var op='';
            $.each(res,function (i,n){
                op=op+('<option value ='+res[i].code+'>'+res[i].name+'</option>')
            })

            $('#M_update_city').append(op);
            $('#M_update_city').val(area);
        },
        error: function (xhr, textStatus, errorThrown) {
            alert("亲，初始化省列表出错，请联系管理员！");
        }
    });

    $.ajax({
        url:  '/system/address/loadAllData/'+2+'/'+area,
        method: 'post',
        data:"{'type':0,'code':0}",
        success: function (res) {

            var op='';
            $.each(res,function (i,n){
                op=op+('<option value ='+res[i].code+'>'+res[i].name+'</option>')
            })

            $('#M_update_area').append(op);
            $('#M_update_area').val(area2);
        },
        error: function (xhr, textStatus, errorThrown) {
            alert("亲，初始化省列表出错，请联系管理员！");
        }
    });



    // 回显更新页面的数据
    $.ajax({
        type:'get',
        url:"/customer/find/"+review_mercNo+".json",
        success:function(res){
            $("#customer-mpos-form-update").json2form(res);
            //遍历拿取图片
            $("#customer-mpos-form-update .upImgs").each(function () {
                $(this).uploadPreview();
            });

        }
    });

    //为省市区赋初值

    $('#M_update_province').change(function(){
        var proAdd=$(this).find("option:selected").attr("value");
        M_update_change_city(1,proAdd);
        $('#M_update_area option:gt(0)').remove();
    });


    $("#M_update_city").change(function (){
        $('#M_update_area option:gt(0)').remove();
        var area=$(this).find("option:selected").attr("value");
        M_update_change_area(2,area)
    });
    function M_update_change_city(e,n) {
        $('#M_update_city option:gt(0)').remove();
        $.ajax({
            url: '/system/address/loadAllData/'+e+'/'+n,
            method: 'post',
            success: function (res) {

                var op='';
                $.each(res,function (i,n){
                    op=op+('<option value ='+res[i].code+'>'+res[i].name+'</option>')
                })
                $('#M_update_city').append(op);
            },
            error: function (xhr, textStatus,
                             errorThrown) {
                alert("亲，初始化省列表出错，请联系管理员！");
            }
        })
    }
    function M_update_change_area(e,n) {

        if(n==0){
            $('#M_update_area option:gt(0)').remove();
            return false;
        }
        $('#M_update_area option:gt(0)').remove();
        $.ajax({
            url: '/system/address/loadAllData/'+e+'/'+n,
            method: 'post',
            success: function (res) {

                var op='';
                $.each(res,function (i,n){
                    op=op+('<option value ='+res[i].code+'>'+res[i].name+'</option>')
                })

                $('#M_update_area').append(op);
            },
            error: function (xhr, textStatus,
                             errorThrown) {
                alert("亲，初始化省列表出错，请联系管理员！");
            }
        })
    };


    var $form=$("#customer-mpos-form-update");
    //表单提交开始
    $form.formValidation({ //开始表单验证
        message: '此值无效', //此值无效
        excluded: ["#paramsYybName", "#directorUserName", "#ywzgName", ":disabled"],
        icon: {
            valid: 'glyphicon',
            invalid: 'glyphicon'
        },
        fields: {

            "customer.agentName": {//商户代码
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '商户代码不能为空！'
                    }
                }
            },
            "customer.mercNameShort": { //商户简称
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '商户简称不能为空！'
                    }
                }
            },

            "customer.mercName": { //商户名称
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '商户名称不能为空！'
                    }
                }
            },
            //商户附加信息
            "customer.industry": { //商户所属行业
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '商户所属行业不能为空！'
                    },
                    between:{
                        min:1,
                        max:10000000000,
                        message:"请重新选择！"
                    }
                }
            },
            "customer.mcc": { //商户类别(MCC)
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '商户类别(MCC)不能为空！'
                    },
                    between:{
                        min:1,
                        max:10000000000,
                        message:"请重新选择！"
                    }
                }
            },
            "customer.address": { //商户类别所属地址
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '商户所属地址不能为空！'
                    }
                }
            },
            "customer.businessLicense": { //商户营业执照号
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '商户营业执照号不能为空！'
                    }
                }
            },

            //法人姓名
            'customer.legalName': {
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '法人姓名不能为空！'
                    },
                    stringLength: {
                        min: 1,
                        max: 20,
                        message: "请输入20以内的字符！"

                    } ,
                    callback: {
                        callback: function (value, validator) {
                            $("#regaccountName").val(value);
                            return true;
                        }
                    }
                }
            },

            'customer.idCard': { //法人身份证号码
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '身份证号码不能为空！'
                    },
                    regexp: {
                        regexp:/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/,
                        message: '请输入18位正确的身份证号码！'
                    }

                }
            },
            //验证经营地址
            'customer.peovinceId': { //商户经营地址，省
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '请选择省份！'
                    },
                    between: {
                        min:1,
                        max: 100000000000000,
                        message: '请重新选择'
                    }
                }
            },
            'customer.cityId': { //商户经营地址，市
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '请选择市或区！'
                    },
                    between: {
                        min:1,
                        max: 100000000000000,
                        message: '请重新选择'
                    }
                }
            },
            'customer.areaCode': { //商户经营地址，区
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '请选择区或县！'
                    },
                    between: {
                        min:1,
                        max: 100000000000000,
                        message: '请重新选择'
                    }
                }
            },

            'customer.branchbankName': { //开户支行名称
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '开户支行名称不能为空！'
                    }
                }
            },
            'customer.accountName': { //结算账户名称,bankCode
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '结算账户名称不能为空！'
                    }
                }
            },

            'customer.accountNo': { //结算账号
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '输入不能为空！'
                    },
                    regexp: {
                        regexp: /^\d{16,19}$/,
                        message: '请输入为16至19位数字'
                    }
                }
            },
            'customer.swingCardLimit': { //刷卡成本信息-借记卡封顶手续费
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '输入不能为空！'
                    },
                    between: {
                        min:agent_up.swingCardLimit,
                        max: 100000000000000,
                        message: '请输入正确的数值'
                    }
                }
            },
            'customer.swingCardDebitRate': { //刷卡成本信息-借记卡手续费
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '输入不能为空！'
                    },
                    between: {
                        min:agent_up.swingCardDebitRate ,
                        max: 100000000000000,
                        message: '请输入正确的数值'
                    }
                }
            },
            'customer.swingCardCreditRate': { //刷卡成本信息-贷记卡手续费
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '输入不能为空！'
                    },
                    between: {
                        min:agent_up.swingCardCreditRate ,
                        max: 100000000000000,
                        message: '请输入正确的数值'
                    }
                }
            },
            'customer.swingCardSettleFee': { //刷卡成本信息-交易结算手续费
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '输入不能为空！'
                    },
                    between: {
                        min:agent_up.swingCardSettleFee ,
                        max: 100000000000000,
                        message: '请输入正确的数值'
                    }
                }
            },

            //无卡成本信息（借贷记一致）,两个始终一致
            'customer.nonCardCreditRate': { //第1个
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '输入不能为空！'
                    },
                    between: {
                        min:agent_up.nonCardCreditRate ,
                        max: 100000000,
                        message: '请输入正确的数值'
                    }
                }
            },

            //传统POS成本信息（借记卡封顶费率及成本与手刷相同）


            'customer.posDebitRate': {//传统POS成本信息-借记卡手续费
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '输入不能为空！'
                    },
                    between: {
                        min:agent_up.posDebitRate ,
                        max: 100000000000000,
                        message: '请输入正确的数值'
                    }
                }
            },
            //
            'customer.posCreditRate': {//传统POS成本信息-贷记卡手续费
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '输入不能为空！'
                    },
                    between: {
                        min:agent_up.posCreditRate ,
                        max: 100000000000000,
                        message: '请输入正确的数值'
                    }
                }
            },
            'customer.posSettleFee': { //传统POS成本信息-交易结算手续费
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '输入不能为空！'
                    },
                    between: {
                        min:agent_up.posSettleFee ,
                        max: 100000000000000,
                        message: '请输入正确的数值'
                    }
                }
            },
            //扫码成本信息（借贷记一致）
            'customer.scanCodeWxRate': { //扫码成本信息-微信手续费
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '输入不能为空！'
                    },
                    between: {
                        min:agent_up.scanCodeWxRate ,
                        max: 100000000000000,
                        message: '请输入正确的数值'
                    }
                }
            },
            'customer.scanCodeZfbRate': { //扫码成本信息-支付宝手续费
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '输入不能为空！'
                    },
                    between: {
                        min:agent_up.scanCodeZfbRate ,
                        max: 100000000000000,
                        message: '请输入正确的数值'
                    }
                }
            },
            'customer.scanCodeYlRate': { //扫码成本信息-银联扫码手续费
                group: '.form-group',
                validators: {
                    notEmpty: {
                        message: '输入不能为空！'
                    },
                    between: {
                        min:agent_up.scanCodeYlRate ,
                        max: 100000000000000,
                        message: '请输入正确的数值'
                    }
                }
            },
        }
    }) .on('success.form.fv',
            function (e, data) {
                e.preventDefault();
                var checkBox=$("#N_update_custom_tongdao").find("input[type='checkbox']");

                var str="";
                $.each(checkBox,function(i,v){
                    if(checkBox[i].checked){
                        str+=$(this).val().trim()+","
                    }
                });

                str=str.substring(0,str.length-1);
                $("#checkBoxVal").val(str);
                $("#reviewMercNo").val(review_mercNo);
                $("#current_Id").val(current_taskId);
                $form.find('[type="submit"]').addClass('disabled').prop("disabled", true);
                //判断oss是否上传
                // var lpPhoto = $form.find('input[name="imgList[0].url"]').val();
                // var lpCardIdProsphoto = $form.find('input[name="imgList[1].url"]').val();
                // var lpCardIdConsPhoto = $form.find('input[name="imgList[2].url"]').val();
                // var bankPhoto = $form.find('input[name="imgList[3].url"]').val();


                //上传图片文件

                // if (lpPhoto == null || lpPhoto == '' || lpPhoto == 'undefined') {
                //     UTIL.clickDisappearSwal("请上传法人图片", function () {
                //         $("#customer_confirm_btn").removeClass('disabled').prop("disabled", false);
                //     });

                //     return;
                // }
                // if (lpCardIdProsphoto == null || lpCardIdProsphoto == '' || lpCardIdProsphoto == 'undefined') {
                //     UTIL.clickDisappearSwal("请上传法人身份证正面图片", function () {
                //         $("#customer_confirm_btn").removeClass('disabled').prop("disabled", false);
                //     });
                //     return;
                // }
                // if (lpCardIdConsPhoto == null || lpCardIdConsPhoto == '' || lpCardIdConsPhoto == 'undefined') {
                //     UTIL.clickDisappearSwal("请上传法人身份证反面图片", function () {
                //         $("#customer_confirm_btn").removeClass('disabled').prop("disabled", false);
                //     });
                //     return;
                // }
                // if (bankPhoto == null || bankPhoto == '' || bankPhoto == 'undefined') {
                //     UTIL.clickDisappearSwal("请上传银行卡照片图片", function () {
                //         $("#customer_confirm_btn").removeClass('disabled').prop("disabled", false);
                //     });
                //     return;
                // }

                showLoading();
                UTIL.submitForm({
                    form: "#customer-mpos-form-update",
                    url: "/customer/update.json",
                    success: function () {

                        hideLoading();
                        // 新建成功之后刷新商户查询table
                        if ($("#custom-list")) {
                            $("#custom-list").bootstrapTable("selectPage", 1);
                        }
                        UTIL.autoDisappearSwal("商户修改成功!", function () {
                            UTIL.closeCurrentPage({
                                delUrl: "merchant-Normalinfo-update.html",
                                toUrl: "merchant-query.html"
                            });
                        })
                    }
                })
            });//表单提交结束
    $("#Mposcustomer_update_cancel_btn").click(function () {
        UTIL.closeCurrentPage({
            "delUrl": "merchant-Normalinfo-update.html",
            "toUrl": "merchant-query.html"
        })
    });

    // 旋转图片
    $("#M_update_review-showImg-madal .rotateImg").click(function(){
        ROTATEIMGFLAG = (++ROTATEIMGFLAG) % 4;
        $(this).siblings('img').css({'transform': 'rotate(' + ROTATEIMGFLAG*90 + 'deg)'});
    })


//=========================================================商户二维码==============================================
$('#merchant_imgs_code_table').bootstrapTable();
    function merchant_seach_data(args){
        args.mercNo=merchant_num;
        return args;
    }
$("#merchant_imgs_code").on('click',function () {
    $("#merchant_modal_img").modal("show");
    $('#agent_code_mercht').bootstrapTable('refresh');
})
function agent_code_searh_mercht(args) {
    var jsonData = UTIL.form2json({
        "form":"#serch_form_imgs"
    });

    for(var value in jsonData){
        args[value] = jsonData[value].trim();
    }
    return args;
}
$("#btn_sech_img").on('click',function () {
    $('#agent_code_mercht').bootstrapTable('refresh');
})
$("#merchant_modal_img").on('hide.bs.modal', function () {
    $("#serch_form_imgs input[name='qrCodeNo']").val('');
    $('#agent_code_mercht').bootstrapTable('refresh');
});
var save_box=[];
//var ne_box=[];
//    添加数据
$("#btn_mechart_imgs").on('click',function () {
//    var selectContent2 =ne_box;
    var selectContent = $('#agent_code_mercht').bootstrapTable('getSelections');
    var ap_box=ap_all(selectContent,selectContent2)
        $('#merchant_imgs_code_table').bootstrapTable("append", selectContent);
        $.each(ap_box,function (i,v) {
            save_box.push(v.id);
        })

})
//数据去重方法
//function ap_all(a,b) {
//    if (a.length > b.length) {
//        a1 = a;
//        b1 = b;
//    } else {
//        a1 = b;
//        b1 = a;
//    }
//    var c=[];
//    $(a1).each(function (k, v) {
//        var i = 0;
//        $(b1).each(function (k1, v1) {
//            if (v.id == v1.id) {
//                i = 1
//            }
//        })
//        if (i != 1) {
//            ne_box.push(v)
//            c.push(v);
//        }
//    })
//    return c;
//}




var del_all_box=[];
//   删除静态数据
$("#merchant_imgs_code_del").on('click',function () {
    var selectContent = $('#merchant_imgs_code_table').bootstrapTable('getSelections');
    if(selectContent.length>0){
       $.each(selectContent,function (i,v) {
           del_all_box.push(v.id);
           removeByValue(save_box,v.id);
       })
        $("#mechart_btn_imgs2").modal("show");
    }else{
        UTIL.clickDisappearSwal("请选择要删除的二维码")
    }

})
//单个删除
$("#merchant_btn_sub").on('click',function () {
    var qrCodeId= $("#imgs_id").text();
    var ig_mercNo= $("#ig_mercNo").text();
    var ig_lg_Id= $("#ig_qrCodeId").text();


    if (ig_mercNo.length>0){
        $("#mechart_btn_imgs").modal("hide");
        showLoading();
        var del_qid=[qrCodeId]
        $.ajax({
            url: "/qrcode/customer/delete",
            type: 'POST',
            data:JSON.stringify(del_qid),
            success: function (res) {
                hideLoading();
                //实例化表格
                if (res.result=='success'){
                    UTIL.clickDisappearSwal("删除二维码成功");
                    $('#merchant_imgs_code_table').bootstrapTable('refresh');
                }else{
                    UTIL.clickDisappearSwal(res.msg);
                }
            },
            error: function (res) {
                hideLoading();
                UTIL.clickDisappearSwal("删除二维码失败，请联系管理员");
            }
        });
    }else{
        $("#mechart_btn_imgs").modal("hide");
       var  SKUNo=[ig_lg_Id]
        console.log(SKUNo)
        //    单个删除内容
        removeByValue(save_box,qrCodeId);
        $('#merchant_imgs_code_table').bootstrapTable('remove', {
            field: 'qrCodeId',
            values: SKUNo
        })

    }
})
//多个删除
$("#merchant_btn_sub2").on('click',function () {
        $("#mechart_btn_imgs2").modal("hide");
        showLoading();
        $.ajax({
            url: "/qrcode/customer/delete",
            type: 'POST',
            data:JSON.stringify(del_all_box),
            success: function (res) {
                hideLoading();
                //实例化表格
                if (res.result=='success'){
                    UTIL.clickDisappearSwal("删除二维码成功");
                    $('#merchant_imgs_code_table').bootstrapTable('refresh');
//                    群体删除
                    save_box=[];
                }else{
                    UTIL.clickDisappearSwal(res.msg);
                }
            },
            error: function (res) {
                hideLoading();
                UTIL.clickDisappearSwal("删除二维码失败，请联系管理员");
            }
        });
})

//    删除指定想方法；
function removeByValue(arr, val) {
    for(var i=0; i<arr.length; i++) {
        if(arr[i] == val) {
            arr.splice(i, 1);
            break;
        }
    }
}
//保存数据
$("#merchant_imgs_code_save").on('click',function () {
    var save_data={'mercNo':merchant_num,'qrCodes':save_box}
if (save_box.length>0){
    showLoading();
    $.ajax({
        type : "post",
        dataType : "json",
        contentType : "application/json",
        url : "/qrcode/customer/save",
        data:JSON.stringify(save_data),
        success : function(res) {
            hideLoading();
            UTIL.clickDisappearSwal("保存成功")
            $("#merchant_imgs_code_table").bootstrapTable("refresh");
        },
        error : function() {
            hideLoading();
            UTIL.clickDisappearSwal("保存失败!")
        }
    });
}else{
    UTIL.clickDisappearSwal("没有要保存的数据!")
}

})


//删除查看事件
function mech_code_some(index,row){
    merchantTemp = ['<a href="javascript:void(0)" style="margin-left: 10px;"title="二维码查看"><img src="../imgs/del-sm.png"  alt=""  style="margin-right: 10px;" onclick="me_modal_show_imgcode(\''+ row.id+ ","+row.qrCodeId+ "," + row.mercNo + '\')"><img src="../imgs/img_code.png"  alt="" onclick="me_modal_show_imgcode_down(\'' + row.qrcodePath + '\')"></a>'
    ]
    return merchantTemp;
}



//删除事件
function me_modal_show_imgcode(rp){
    var arry_box = rp.split(",");
    console.log(arry_box)
    var imgs_id = arry_box[0];
    var ig_qrCodeId = arry_box[1];
    var ig_mercNo=arry_box[2]
    $("#imgs_id").text(imgs_id);
    $("#ig_qrCodeId").text(ig_qrCodeId);
    $("#ig_mercNo").text(ig_mercNo);
    $("#mechart_btn_imgs").modal("show");
}


//    二维码查看
function me_modal_show_imgcode_down(rp) {
    var img_url = OSSHOST + rp
    $("#me_key").text(rp)
    $("#me_mer_imgcode").attr('src', img_url)
    $("#me_img_uplod_updown").modal('show')
}
//下载
$("#me_profit_btn_code").click(function () {
    var simpKey =  $("#me_key").text()
    $.ajax({
        type: "POST",
        dataType: "text",
        contentType: "application/json",
        url: "/auth/setOssMeta.json?key=" + simpKey,
        success: function (res) {
            $("#me_img_uplod_updown").modal('hide')
            if (res) {
                window.location = OSSHOST + res;
            } else {
                UTIL.clickDisappearSwal("文件下载失败");
            }
        }
    });
});
</script>