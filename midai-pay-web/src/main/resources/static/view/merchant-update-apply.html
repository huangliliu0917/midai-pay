<!-- 商户信息修改 -->
<script type="text/tmpl" id="optionTmpl">
					<option data-code="{{code}}" data-value="{{name}}" value="{{code}}">{{name}}</option>


</script>
<script type="text/tmpl" id="cityTmpl">
					<option data-code="{{code}}" data-father="{{father}}" value="{{code}}">{{name}}</option>


</script>
<script type="text/tmpl" id="bankTmpl">
					<option data-code="{{bankcode}}" data-shortcode="{{shortcode}}" data-value="{{showname}}" value="{{bankcode}}">{{showname}}</option>


</script>

<div class="container-fluid" id="merchant-update">
    <form class="form-horizontal row-border" method="post" role="form" id="customer-update-form">
        <!--商户新建申请-->
        <div class="row">
            <input type="hidden" name="customer.state"/>

            <div class="col-md-12">
                <div class="widget box">
                    <div class="widget-header"><h4><i class="icon-form"></i>商户申请</h4></div>
                    <div class="widget-content">

                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="col-md-4 control-label">商户编号<span class="required">*</span></label>

                                    <div class="col-md-8">
                                        <input type="text" name="customer.mercNo" class="form-control" readonly="readonly"/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group"><label class="col-md-4 control-label">代理商编号<span
                                        class="required">*</span></label>

                                    <div class="col-md-8">
                                        <!-- <div class="input-group"> -->
                                            <input type="text" name="customer.agentId" id="agentId" class="form-control" readonly="readonly"/>
                                            <!-- <span class="input-group-addon bg-green btn" data-toggle="modal" id="merchant-edit-modal-show"><span
                                                    class="glyphicon glyphicon-search"></span></span>
                                        </div> -->
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="col-md-4 control-label">代理商名称<span class="required">*</span></label>

                                    <div class="col-md-8">
                                        <input type="text" name="customer.agentName" id="agentName" class="form-control" readonly="readonly"/>

                                        <!--顶级代理商ID  -->
                                        <input type="hidden" name="customer.topAgentId" id="topAgentId">
                                        <!--顶级代理商名称 -->
                                        <input type="hidden" name="customer.topAgentName" id="topAgentName">
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="col-md-4 control-label">商户名称<span class="required">*</span></label>

                                    <div class="col-md-8">
                                        <input type="text" name="customer.mercName" class="form-control" maxlength="100"/>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group"><label class="col-md-4 control-label">商户手机号<span
                                        class="required">*</span></label>

                                    <div class="col-md-8">
                                        <input type="text" name="customer.mobile" class="form-control required email" maxlength="11">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group"><label class="col-md-4 control-label">法人姓名<span
                                        class="required">*</span></label>

                                    <div class="col-md-8">
                                        <input type="text" name="customer.legalName" id="reglegalNameUpdate" class="form-control required url" maxlength="30">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="col-md-4 control-label">法人身份证<span class="required">*</span></label>

                                    <div class="col-md-8">
                                        <input type="text" name="customer.idCard" class="form-control" maxlength="18"/>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group"><label class="col-md-4 control-label">商户类型<span class="required">*</span></label>

                                    <div class="col-md-8">
                                        <select id="merType" name="customer.merType" class="form-control">
                                            <option value="1">个人</option>
                                            <option value="3">普通商户</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row hideLoop">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="col-md-2 control-label">商户地址<span class="required">*</span></label>

                                    <div class="col-md-10">
                                        <input type="text" name="customer.address" class="form-control" maxlength="100"/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="col-md-4 control-label">商户类别<span class="required">*</span> </label>

                                    <div class="col-md-8">
                                        <label class="radio-inline"><input type="radio" class="uniform" name="customer.merAuto"
                                                                           value="1">自动到账商户</label>
                                        <label class="radio-inline"><input type="radio" class="uniform" name="customer.merAuto"
                                                                           value="0" checked>普通商户</label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3"></div>
                        </div>


                        <div class="row hideLoop">
                            <div class="col-md-12">
                                <div class="form-group"><label class="col-md-1 control-label">许可经营范围</label>

                                    <div class="col-md-11">
                                        <input type="text" name="customer.scobus" class="form-control" maxlength="200">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 hideLoop">
                                <div class="form-group">
                                    <label class="col-md-2 control-label">申请设备</label>

                                    <div class="col-md-10">
                                        <input type="text" name="customer.description" class="form-control" maxlength="100"/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group"><label class="col-md-4 control-label">省<span
                                        class="required">*</span></label>

                                    <div class="col-md-8">
                                        <select name="customer.peovinceId" id="register-province" class="form-control"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group"><label class="col-md-4 control-label">市<span
                                        class="required">*</span></label>

                                    <div class="col-md-8">
                                        <select name="customer.cityId" id="register-city" class="form-control"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="addClearfix clearfix">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-md-4 control-label">开户名<span class="required">*</span></label>

                                        <div class="col-md-8">
                                            <input type="text" name="customer.accountName" id="regaccountNameUpdate"  class="form-control" maxlength="20" readonly="readonly"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group"><label class="col-md-4 control-label">开户主账号<span
                                            class="required">*</span></label>

                                        <div class="col-md-8">
                                            <input type="text" name="customer.accountNo" class="form-control required email" maxlength="19">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group"><label class="col-md-4 control-label">开户总行名称<span
                                        class="required">*</span></label>

                                    <div class="col-md-8">
                                        <select name="customer.bankId" id="merchantUpdateBankId" class="form-control"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="col-md-4 control-label">开户支行名称<span class="required">*</span></label>

                                    <div class="col-md-8">
                                        <div class="input-group">
                                            <input type="text" id="merchantUpdateBranchbankName" name="customer.branchbankName" class="form-control"
                                                   readonly="readonly"/>
                                            <input type="hidden" id="merchantUpdateBranchbankId" name="customer.branchbankId" class="form-control"/>
                                                <span class="input-group-addon bg-green btn" data-toggle="modal" id="bank-edit-modal-show"><span
                                                        class="glyphicon glyphicon-search"></span></span>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="hideLoop">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-md-4 control-label">业务联系人</label>

                                        <div class="col-md-8">
                                            <input type="text" name="customer.merlinkman" class="form-control" maxlength="30"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group"><label class="col-md-4 control-label">联系人手机</label>

                                        <div class="col-md-8">
                                            <input type="text" name="customer.merlinkmobile" class="form-control required email" maxlength="11">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group"><label class="col-md-4 control-label">联系人邮箱</label>

                                        <div class="col-md-8">
                                            <input type="text" name="customer.email" class="form-control" maxlength="30"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-md-4 control-label">联系人QQ</label>

                                        <div class="col-md-8">
                                            <input type="text" name="customer.qq" class="form-control" maxlength="20"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="clearfix" style="padding-top: 15px;">
                            <div class="widget box">
                                <div class="widget-header">
                                    <h4><i class="icon-role-list-small"></i>商户资质附件
                                    </h4>
                                </div>
                                <div class="widget-content" style="padding-top:15px;">
                                    <div class="row">
                                        <div class="col-md-1"></div>
                                        <div class="col-md-2">
                                            <div class="upImgs" data-showmodal="up-showImg-madal">
                                                <div class="main-div">
                                                    <a id="up-acc-del-1" class="del-btu del-normal" href="javascript:void(0);"></a>
                                                    <a id="up-acc-show-1" class="show-btu show-normal" href="javascript:void(0);"></a>

                                                    <div>
                                                        <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image"
                                                             style="height: 154px !important;">
                                                    </div>
                                                    <input type="file" id="up-upload-file-1" class="file image-input">
                                                    <input type="button" id="up-acc-upload-1" class="showbtu" value="上传">
                                                    <input type="button" id="up-acc-download-1" class="downloadbtn" value="下载">
                                                    <input type="hidden" name="imgs[0].type" value="1">
                                                    <input type="hidden" name="imgs[0].url" class="fileUrl" value="">

                                                    <div style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;">
                                                        <div class="progress">
                                                            <div class="progress-bar" style="width: 0%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span style="display:block; height:24px;text-align: center; font-weight: bold; line-height: 24px;">法人照片(手持身份证照片)</span>
                                            </div>

                                        </div>
                                        <div class="col-md-1"></div>
                                        <div class="col-md-2">
                                            <div class="upImgs" data-showmodal="up-showImg-madal">
                                                <div class="main-div">
                                                    <a id="up-acc-del-2" class="del-btu del-normal" href="javascript:void(0);"></a>
                                                    <a id="up-acc-show-2" class="show-btu show-normal" href="javascript:void(0);"></a>

                                                    <div>
                                                        <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image"
                                                             style="height: 154px !important;">
                                                    </div>
                                                    <input type="file" id="up-upload-file-2" class="file image-input">
                                                    <input type="button" id="up-acc-upload-2" class="showbtu" value="上传">
                                                    <input type="button" id="up-acc-download-2" class="downloadbtn" value="下载">
                                                    <input type="hidden" name="imgs[1].type" value="2">
                                                    <input type="hidden" name="imgs[1].url" class="fileUrl" value="">

                                                    <div style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;">
                                                        <div class="progress">
                                                            <div class="progress-bar" style="width: 0%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span style="display:block; height:24px;text-align: center; font-weight: bold; line-height: 24px;">法人身份证正面</span>
                                            </div>
                                        </div>
                                        <div class="col-md-1"></div>
                                        <div class="col-md-2">
                                            <div class="upImgs" data-showmodal="up-showImg-madal">
                                                <div class="main-div">
                                                    <a id="up-acc-del-3" class="del-btu del-normal" href="javascript:void(0);"></a>
                                                    <a id="up-acc-show-3" class="show-btu show-normal" href="javascript:void(0);"></a>

                                                    <div>
                                                        <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image"
                                                             style="height: 154px !important;">
                                                    </div>
                                                    <input type="file" id="up-upload-file-3" class="file image-input">
                                                    <input type="button" id="up-acc-upload-3" class="showbtu" value="上传">
                                                    <input type="button" id="up-acc-download-3" class="downloadbtn" value="下载">
                                                    <input type="hidden" name="imgs[2].type" value="3">
                                                    <input type="hidden" name="imgs[2].url" class="fileUrl" value="">

                                                    <div style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;">
                                                        <div class="progress">
                                                            <div class="progress-bar" style="width: 0%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span style="display:block; height:24px;text-align: center; font-weight: bold; line-height: 24px;">法人身份证反面</span>
                                            </div>
                                        </div>
                                        <div class="col-md-1"></div>
                                        <div class="col-md-2">
                                            <div class="upImgs" data-showmodal="up-showImg-madal">
                                                <div class="main-div">
                                                    <a id="up-acc-del-4" class="del-btu del-normal" href="javascript:void(0);"></a>
                                                    <a id="up-acc-show-4" class="show-btu show-normal" href="javascript:void(0);"></a>

                                                    <div>
                                                        <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image"
                                                             style="height: 154px !important;">
                                                    </div>
                                                    <input type="file" id="up-upload-file-4" class="file image-input">
                                                    <input type="button" id="up-acc-upload-4" class="showbtu" value="上传">
                                                    <input type="button" id="up-acc-download-4" class="downloadbtn" value="下载">
                                                    <input type="hidden" name="imgs[3].type" value="4">
                                                    <input type="hidden" name="imgs[3].url" class="fileUrl" value="">

                                                    <div style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;">
                                                        <div class="progress">
                                                            <div class="progress-bar" style="width: 0%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span style="display:block; height:24px;text-align: center; font-weight: bold; line-height: 24px;">银行卡照片</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hideLoop init-hide show-custom-update">
                                        <div class="row" style="margin-top:20px;margin-bottom: 20px;">
                                            <div class="col-md-1"></div>
                                            <div class="col-md-2">
                                                <div class="upImgs" data-showmodal="up-showImg-madal">
                                                    <div class="main-div">
                                                        <a id="up-acc-del-5" class="del-btu del-normal" href="javascript:void(0);"></a>
                                                        <a id="up-acc-show-5" class="show-btu show-normal" href="javascript:void(0);"></a>

                                                        <div>
                                                            <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image"
                                                                 style="height: 154px !important;">
                                                        </div>
                                                        <input type="file" id="up-upload-file-5" class="file image-input">
                                                        <input type="button" id="up-acc-upload-5" class="showbtu" value="上传">
                                                        <input type="button" id="up-acc-download-5" class="downloadbtn" value="下载">
                                                        <input type="hidden" name="imgs[4].type" value="5">
                                                        <input type="hidden" name="imgs[4].url" class="fileUrl" value="">

                                                        <div style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;">
                                                            <div class="progress">
                                                                <div class="progress-bar" style="width: 0%"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <span style="display:block; height:24px;text-align: center; font-weight: bold; line-height: 24px;">经营资质</span>
                                                </div>
                                            </div>
                                            <div class="col-md-1"></div>
                                            <div class="col-md-2">
                                                <div class="upImgs" data-showmodal="up-showImg-madal">
                                                    <div class="main-div">
                                                        <a id="up-acc-del-6" class="del-btu del-normal" href="javascript:void(0);"></a>
                                                        <a id="up-acc-show-6" class="show-btu show-normal" href="javascript:void(0);"></a>

                                                        <div>
                                                            <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image"
                                                                 style="height: 154px !important;">
                                                        </div>
                                                        <input type="file" id="up-upload-file-6" class="file image-input">
                                                        <input type="button" id="up-acc-upload-6" class="showbtu" value="上传">
                                                        <input type="button" id="up-acc-download-6" class="downloadbtn" value="下载">
                                                        <input type="hidden" name="imgs[5].type" value="6">
                                                        <input type="hidden" name="imgs[5].url" class="fileUrl" value="">

                                                        <div style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;">
                                                            <div class="progress">
                                                                <div class="progress-bar" style="width: 0%"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <span style="display:block; height:24px;text-align: center; font-weight: bold; line-height: 24px;">经营场景1</span>
                                                </div>
                                            </div>
                                            <div class="col-md-1"></div>
                                            <div class="col-md-2">
                                                <div class="upImgs" data-showmodal="up-showImg-madal">
                                                    <div class="main-div">
                                                        <a id="up-acc-del-7" class="del-btu del-normal" href="javascript:void(0);"></a>
                                                        <a id="up-acc-show-7" class="show-btu show-normal" href="javascript:void(0);"></a>

                                                        <div>
                                                            <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image"
                                                                 style="height: 154px !important;">
                                                        </div>
                                                        <input type="file" id="up-upload-file-7" class="file image-input">
                                                        <input type="button" id="up-acc-upload-7" class="showbtu" value="上传">
                                                        <input type="button" id="up-acc-download-7" class="downloadbtn" value="下载">
                                                        <input type="hidden" name="imgs[6].type" value="7">
                                                        <input type="hidden" name="imgs[6].url" class="fileUrl" value="">

                                                        <div style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;">
                                                            <div class="progress">
                                                                <div class="progress-bar" style="width: 0%"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <span style="display:block; height:24px;text-align: center; font-weight: bold; line-height: 24px;">经营场景2</span>
                                                </div>
                                            </div>
                                            <div class="col-md-1"></div>
                                            <div class="col-md-2">
                                                <div class="upImgs" data-showmodal="up-showImg-madal">
                                                    <div class="main-div">
                                                        <a id="up-acc-del-8" class="del-btu del-normal" href="javascript:void(0);"></a>
                                                        <a id="up-acc-show-8" class="show-btu show-normal" href="javascript:void(0);"></a>

                                                        <div>
                                                            <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image"
                                                                 style="height: 154px !important;">
                                                        </div>
                                                        <input type="file" id="up-upload-file-8" class="file image-input">
                                                        <input type="button" id="up-acc-upload-8" class="showbtu" value="上传">
                                                        <input type="button" id="up-acc-download-8" class="downloadbtn" value="下载">
                                                        <input type="hidden" name="imgs[7].type" value="8">
                                                        <input type="hidden" name="imgs[7].url" class="fileUrl" value="">

                                                        <div style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;">
                                                            <div class="progress">
                                                                <div class="progress-bar" style="width: 0%"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <span style="display:block; height:24px;text-align: center; font-weight: bold; line-height: 24px;">补充照片</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row" style="margin-top:20px;margin-bottom: 20px;">
                                            <div class="col-md-1"></div>
                                            <div class="col-md-2">
                                                <div class="upImgs" data-showmodal="up-showImg-madal">
                                                    <div class="main-div">
                                                        <a id="new-acc-del-9" class="del-btu del-normal" href="javascript:void(0);"></a>
                                                        <a id="new-acc-show-9" class="show-btu show-normal" href="javascript:void(0);"></a>

                                                        <div>
                                                            <img src="../imgs/upload-bg.gif" width="180" height="156" class="ImgPr image"
                                                                 style="height: 154px !important;">
                                                        </div>
                                                        <input type="file" id="new-upload-file-9" class="file image-input">
                                                        <input type="button" id="new-acc-upload-9" class="showbtu" value="上传">
                                                        <input type="button" id="new-acc-download-9" class="downloadbtn" value="下载">
                                                        <input type="hidden" name="imgs[8].type" value="9">
                                                        <input type="hidden" name="imgs[8].url" class="fileUrl" value="">

                                                        <div style=" width:100%;height: 6px; position: absolute;bottom: 29px; display: none;">
                                                            <div class="progress">
                                                                <div class="progress-bar" style="width: 0%"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <span class="certificate-picture">其他照片</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-md-1 control-label">备注</label>

                                    <div class="col-md-11">
                                        <textarea name="customer.note" class="form-control required url" rows="6" style="resize: none;" maxlength="200"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="widget box">
                    <div class="widget-header">
                        <div class="col-md-4 no-padding"><h4><i class="icon-list"></i>手机商户设备表</h4></div>
                        <div class="col-md-8 no-padding">
                            <div class="toolbar no-padding">
                                <input type="button" class="btn btn-success pull-right add-device-btn" data-toggle="modal" id="device-edit-modal-show"
                                       value="增&nbsp;&nbsp;加">
                                <input type="button" class="btn btn-default pull-right del-device-btn" value="删&nbsp;&nbsp;除">
                            </div>
                        </div>
                    </div>
                    <div class="widget-content no-padding">
                        <table data-toggle="table" id="edit-device-list"
                               class="table table-striped table-checkable table-hover table-bordered"
                               data-query-params="deviceListQuery"
                               data-url="/customer/loadCustomerDevice.json"
                               data-method="post">

                            <thead>
                            <tr>
                                <th data-field="" data-align="center"
                                    data-checkbox="true"><input type="checkbox"
                                                                data-toggle="checkbox" class="uniform"/>
                                </th>
                                <th data-field="deviceNo" data-align="left">机身号</th>
                                <th data-field="createTime" data-align="left">创建时间</th>
                                <th data-field="isFirst" data-align="left" data-formatter="firstSelectUpdate">首选项</th>
                                <th data-field="typeName" data-align="left">设备类型</th>
                                <th data-field="modeName" data-align="left">设备名称</th>
                            </tr>
                            </thead>
                        </table>
                        <tbody></tbody>
                    </div>
                </div>


                <div class="row">
                    <div class="col-md-12">
                        <div class="widget box">
                            <div class="widget-header"><h4><i class="icon-form"></i>商户签约扣率</h4></div>
                            <div class="widget-content">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="form-group"><label class="col-md-4 control-label">借记卡扣率<span class="required">*</span></label>

                                            <div class="col-md-8">
                                                <div class="input-group">
                                                    <input type="text" name="customer.feeRate" class="form-control" maxlength="5"/>
                                                    <span class="input-group-addon">%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="col-md-4 control-label">单笔手续费<span class="required">*</span></label>

                                            <div class="col-md-8">
                                               <div class="input-group">
                                                   <input type="text" name="customer.singleFee" class="form-control required email" maxlength="11">
                                                    <span class="input-group-addon">元</span>
                                               </div>                                               
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group"><label class="col-md-4 control-label">贷记卡扣率<span class="required">*</span></label>

                                            <div class="col-md-8">
                                                <div class="input-group">
                                                    <input type="text" name="customer.dfeeRate" class="form-control" maxlength="5"/>
                                                    <span class="input-group-addon">%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
	                                   <div class="row">
										<div class="col-md-3">
											<div class="form-group">
												<label class="col-md-4 control-label">商户状态<span
													class="required">*</span>
												</label>
												<div class="col-md-8">
													<select name="instCode" class="form-control" >
														<option value="0">全通道</option>
														<option value="301000000001">翰银</option>
														<option value="00000081">申鑫</option>
													</select>
												</div>
											</div>
										</div>
									</div>
                                    <div class="col-md-3">
                                        <input type="hidden" name="customer.opstate" value="1"/>
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                                <p class="form-actions">
                                    <input type="submit" value="确认" id="customer_update_confirm_btn" class="btn btn-success pull-right">
                                    <input type="button" value="取消" id="customer_update_cancel_btn" class="btn btn-default pull-right">
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>


<!-- 代理商名称过滤条件模态框 -->
<div class="modal fade" id="merchant-edit-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">过滤条件</h4>
            </div>
            <div class="modal-body">
                <div id="" class="form-horizontal">
                    <div class="row">
                        <div class="col-md-5">
                            <div class="form-group"><label class="col-md-5 control-label">代理商编号</label>

                                <div class="col-md-7">
                                    <input type="text" name="agentNo" class="form-control"></div>
                            </div>
                        </div>
                        <div class="col-md-5">
                            <div class="form-group">
                                <label class="col-md-5 control-label">代理商名称</label>

                                <div class="col-md-7">
                                    <input type="text" name="name" class="form-control">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <button class="btn btn-success sb-agent-check-btn pull-right">查询</button>
                        </div>
                    </div>
                </div>

                <table data-toggle="table" id="editTable"
                       class="table table-striped table-checkable table-hover table-bordered"
                       data-query-params="merchantUpdateAgentBean"
                       data-url="/agent/queryNoAndNameTopList.json" data-pagination="true"
                       data-side-pagination="server" data-page-size="5"
                       data-pagination-first-text="First"
                       data-pagination-pre-text="上一页" data-pagination-next-text="下一页"
                       data-pagination-loop="false" data-page-list=[5]
                       data-pagination-last-text="Last" data-method="post">


                    <thead>
                    <tr>
                        <th data-field="" data-radio="true"></th>
                        <th data-field="agentNo">代理商编号</th>
                        <th data-field="name">代理商名称</th>
                        <th data-field="topAgentId">顶级代理商编号</th>
                        <th data-field="topAgentName">顶级代理商名称</th>
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关&nbsp;&nbsp;闭</button>
                <button type="button" class="btn btn-success confirm-btn">确&nbsp;&nbsp;定</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div><!-- /.modal -->


<!--支行信息模态框-->
<div class="modal fade" id="bank-edit-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">查询支行信息</h4>
            </div>
            <div class="modal-body">
                <div id="sbbg-query" class="form-horizontal">
                    <div class="row">
                        <div class="col-md-5">
                            <div class="form-group"><label class="col-md-4 control-label">支行编号</label>

                                <div class="col-md-8">
                                    <input type="text" name="branchbankcode" class="form-control">
                                </div>
                            </div>
                        </div>

                        <div class="col-md-5">
                            <div class="form-group"><label class="col-md-4 control-label">支行名称</label>

                                <div class="col-md-8">
                                    <input type="text" name="branchbankname" class="form-control"></div>
                            </div>
                        </div>

                        <div class="col-md-2">
                            <button class="btn btn-success btn-query pull-right">查询</button>
                        </div>
                    </div>
                </div>
                <table data-toggle="table" id="editbandTable"
                       class="table table-striped table-checkable table-hover table-bordered"
                       data-query-params="merchantUpdateBankBean"
                       data-url="/system/bank/bankBranchList.json" data-pagination="true"
                       data-side-pagination="server" data-page-size="5"
                       data-pagination-first-text="First"
                       data-pagination-pre-text="上一页" data-pagination-next-text="下一页"
                       data-pagination-loop="false" data-page-list=[5]
                       data-pagination-last-text="Last" data-method="post">
                    <thead>
                    <tr>
                        <th data-field="" data-radio="true"></th>
                        <th data-field="branchbankcode">支行编码</th>
                        <th data-field="branchbankname">支行名称</th>
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关&nbsp;&nbsp;闭</button>
                <button type="button" class="btn btn-success btn-shxg-sure">确&nbsp;&nbsp;定</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div><!-- /.modal -->
<!-- 新增模态框结束 -->


<!--手机商户设备表新增模态框-->
<div class="modal fade" id="device-edit-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">过滤条件</h4>
            </div>
            <div class="modal-body">
                <div id="" class="form-horizontal">
                    <div class="row">
                        <div class="col-md-9">
                            <div class="form-group">
                                <label class="col-md-2 control-label">机身号</label>

                                <div class="col-md-6">
                                    <input type="text" name="bodyNoStart" class="form-control">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-success btn-query pull-right">查询</button>
                        </div>
                    </div>
                </div>

                <table data-toggle="table" id="cusEditDeviceAddTable"
                       class="table table-striped table-checkable table-hover table-bordered"
                       data-query-params="deviceQuery"
                       data-url="/device/storage/unbind/list.json" data-pagination="true"
                       data-side-pagination="server" data-page-size="5"
                       data-pagination-first-text="First"
                       data-pagination-pre-text="上一页" data-pagination-next-text="下一页"
                       data-pagination-loop="false" data-page-list=[5]
                       data-pagination-last-text="Last" data-method="post">

                    <thead>
                    <tr>
                        <th data-field="" data-radio="true"></th>
                        <th data-field="deviceNo">机身号</th>
                        <th data-field="typeName">设备类型</th>
                        <th data-field="modeName">设备名称</th>
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="modal-footer">
                <div class="form-horizontal">
                    <div class="row hide-default">
                        <div class="col-lg-12">
                            <div class="form-group">
                                <label class="col-md-3 control-label">是否是首选项 </label>

                                <div class="col-md-6">
                                    <select id="isFirst" name="isFirst" class="form-control">
                                        <option value="0">否</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-default" data-dismiss="modal">关&nbsp;&nbsp;闭</button>
                <button type="button" class="btn btn-success confirm-btn">确&nbsp;&nbsp;定</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div><!-- /.modal -->
<!-- 新增模态框结束 -->


<!-- 删除手机商户设备表模态框 -->
<div class="modal fade" id="device-delete-edit-madal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">手机商户设备表</h4>
            </div>
            <div class="modal-body">
                <p class="align-center">
                    确定删除选中的设备吗？
                </p>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关&nbsp;&nbsp;闭</button>
                <button type="button" id="device-confirm_btn" class="btn btn-success">确&nbsp;&nbsp;定</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div><!-- /.modal -->

<!-- 图片预览模态框 -->
<div class="modal fade" id="up-showImg-madal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title align-center imgTitle"></h4>
            </div>
            <div class="modal-body">
                <div class="modal-pic-review">
                    <img src="" width="100%" height="100%" style="width: 500px;height: 500px;">
                    <input type="button" class="rotateImg" placeholder="顺时针旋转90°" />
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关&nbsp;&nbsp;闭</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div><!-- /.modal -->
<script type="text/javascript" src="js/oss/upLoadFileUI.js"></script>


<script type="text/javascript">
    $(".change-del-equipment-btn").on("click", function () {
        $("#sbbg-delete-madal").modal("show");
    })
</script>


<script>
    //手机商户设备表  ---首选项
    function firstSelectUpdate(index, row) {
        var firstSelectList = row.isFirst;
        if (firstSelectList == "0") {
            return "否"
        } else {
            return "首选"
        }
    }

    //获取当前页面的参数
;
    var up_args = UTIL.readUrlData({"currentUrl": "merchant-update-apply.html"});
    console.log( UTIL.readUrlData);
    var up_mercNo = up_args["mercNo"];
    var up_agentId = up_args["agentId"];


    //代理商模态窗口初始化数据
    function merchantUpdateAgentBean(argms) {
        argms.agentNo = $("#merchant-edit-modal input[name='agentNo']").val().trim() || "";
        argms.name = $("#merchant-edit-modal input[name='name']").val().trim() || "";
        return argms;
    }
    ;

    //银行支行模态窗口初始化数据
    function merchantUpdateBankBean(argms) {
        argms.bankcode = $("#customer-update-form #merchantUpdateBankId  option:selected").data('shortcode');
        argms.branchbankcode = $("#bank-edit-modal input[name='branchbankcode']").val().trim() || "";
        argms.branchbankname = $("#bank-edit-modal input[name='branchbankname']").val().trim() || "";
        return argms;
    }
    ;


    // 手机商户设备列表参数
    function deviceListQuery(argms) {
        argms.mercNo = up_mercNo || "";
        return argms;
    };


    // 手机商户设备新增列表参数
    function deviceQuery(argms) {
        argms.agentNo = up_agentId || "";
        argms.bodyNoStart = $("#device-edit-modal input[name='bodyNoStart']").val().trim() || "";
        return argms;
    };


    $(function () {

        //弹出模态框
        // $('#merchant-edit-modal-show').on('click',function(){
        //     $("#merchant-edit-modal").modal("show");
        // });
        $('#bank-edit-modal-show').on('click', function () {
            $("#bank-edit-modal").modal("show");
        });
        $('#device-edit-modal-show').on('click', function () {
            $("#device-edit-modal").modal("show");
        });
        // 旋转图片
        $("#up-showImg-madal .rotateImg").click(function(){
            ROTATEIMGFLAG = (++ROTATEIMGFLAG) % 4;
            $(this).siblings('img').css({'transform': 'rotate(' + ROTATEIMGFLAG*90 + 'deg)'});
        })

        var cityId;

        var $customerUpdateForm = $('#customer-update-form');
        var $cusUpdateMerHide = $("#customer-update-form .hideLoop");

        $cusUpdateMerHide.hide();
        $cusUpdateMerHide.find("input").prop("disabled", true);
        $cusUpdateMerHide.find("select").prop("disabled", true);
        $('#customer-update-form #register-province').prop("disabled", false);
        $('#customer-update-form #register-city').prop("disabled", false);

        //初始化省市联动
        $.ajax({
            url: "/system/address/loadprovince.json",
            method: 'post',
            success: function (res) {
                var $selectList = $('#customer-update-form select').filter(
                    function () {
                        return ($(this).attr('id') || '').toLowerCase()
                                        .indexOf('province') >= 0;
                    });
                $selectList.empty();
                $selectList.each(function (index) {
                    for (var i = 0; i < res.length; i++) {
                        var str = $("#optionTmpl").html();
                        $(this).append(str.replace(/\{\{code\}\}/g,
                            res[i].code).replace(
                            /\{\{id\}\}/g, res[i].code)
                            .replace(/\{\{name\}\}/g,
                            res[i].name));
                    }
                    // changeProvince($(this));
                    $(this).change(function () {
                        var $that = $(this);
                        changeProvince($that);
                    })
                });
            },
            error: function (xhr, textStatus,
                             errorThrown) {
                alert("亲，初始化省列表出错，请联系管理员！");
            }
        })
        // 省市区的数据联动
        function changeProvince($that, success) {
            var nameStr = $that.attr("id").toLowerCase().replace("province",
                    "city");
            var provinceCode = $('option:selected', $that).data('code')
                    .toString();
            var provsValue = $that.find("option:selected").data("value");
            var provincialCityFlag = "";
            if (provsValue.substr(provsValue.length - 1, 1) == "市") {
                provincialCityFlag = "area";
                provinceCode = provinceCode.substr(0, provinceCode.length - 3)
                        + "100";
            } else {
                provincialCityFlag = "city";
            }

            // 找到和身份对应的城市
            var $selectCity = $('#customer-update-form select').filter(function () {
                return ($(this).attr('id') || '').toLowerCase() == nameStr;
            });
            $.ajax({
                url: "/system/address/loadcity/"
                + provinceCode + "/" + provincialCityFlag + ".json",
                method: 'post',
                success: function (res) {
                    $selectCity.empty();
                    for (var i = 0; i < res.length; i++) {
                        var cityStr = $('#cityTmpl').html();

                        var cityName = cityStr.replace(/\{\{code\}\}/g,
                                res[i].code).replace(/\{\{name\}\}/g,
                                res[i].name).replace(/\{\{father\}\}/g,
                                provinceCode);
                        $selectCity.append(cityName);
                    }
                    if (cityId) {
                        $customerUpdateForm.find("#register-city").val(cityId);
                        cityId = "";
                    }
                    if (success && typeof success === 'function') {
                        success();
                    }

                }
            })
        }

        //初始化开户总行名称列表
        $.ajax({
            url: "/system/bank/loadAllBank",
            method: 'post',
            async: false,
            success: function (res) {
                var $selectBankList = $('#customer-update-form select').filter(
                    function () {
                        return ($(this).attr('id') || '').toLowerCase()
                                        .indexOf('bankid') >= 0;
                    });
                $selectBankList.empty();
                $selectBankList.each(function (index) {
                    for (var i = 0; i < res.length; i++) {
                        var str = $("#bankTmpl").html();
                        $(this)
                                .append(
                                //bankcode shortcode showname
                                str.replace(/\{\{code\}\}/g,
                                        res[i].bankcode).replace(/\{\{bankcode\}\}/g, res[i].bankcode).replace(/\{\{shortcode\}\}/g, res[i].shortcode)
                                        .replace(/\{\{showname\}\}/g, res[i].showname));
                    }
                    // changeBank($(this));
                    $(this).change(function () {
                        var $that = $(this);
                        changeBank($that);
                    });
                });
            },
            error: function (xhr, textStatus,
                             errorThrown) {
                UTIL.clickDisappearSwal("亲，初始化开户总行名称列表出错，请联系管理员！");
            }
        });

        function changeBank($that, success) {
            var shortcodeCode = $('option:selected', $that).data('shortcode')
                    .toString();

            $('#customer-update-form #merchantUpdateBranchbankName').val('');
            $('#customer-update-form #merchantUpdateBranchbankId').val('');
        }


        //加载修改页面
        $.ajax({
            type: "get",
            dataType: "json",
            contentType: "application/json",
            url: "/customer/find/" + up_mercNo + ".json",
            success: function (res) {
                $("#customer-update-form").json2form(res);
                $("#customer-update-form #register-province").change();
                cityId = res.customer.cityId;

                if (res.customer.merType == 1) {
                    $cusUpdateMerHide.hide();
                    $cusUpdateMerHide.find("input").prop("disabled", true);
                    $cusUpdateMerHide.find("select").prop("disabled", true);
                    $('#customer-update-form #register-province').prop("disabled", false);
                    $('#customer-update-form #register-city').prop("disabled", false);
                    $(".addClearfix").addClass("clearfix");

                } else if (res.customer.merType == 3) {
                    $cusUpdateMerHide.show();
                    $('#customer-update-form #register-province').prop("disabled", false);
                    $('#customer-update-form #register-city').prop("disabled", false);
                    $cusUpdateMerHide.find("input").prop("disabled", false);
                    $cusUpdateMerHide.find("select").prop("disabled", false);
                    $(".addClearfix").removeClass("clearfix");
                }


                $("#customer-update-form .upImgs").each(function () {
                    $(this).uploadPreview();
                });
            }
        });

        // 初始化table
        $('[data-toggle="table"]').bootstrapTable();
        // 取消按钮事件
        $("#customer_update_cancel_btn").on("click", function () {
            UTIL.closeCurrentPage({
                "delUrl": "merchant-update-apply.html",
                "toUrl": "merchant-query.html"
            })
        })


        // 厂商模态框中的数据清空-初始化
        $("#merchant-edit-modal").on('hide.bs.modal', function () {
            $("#merchant-edit-modal input[name='agentNo']").val("");
            $("#merchant-edit-modal input[name='name']").val("");
            $("#firstTable").bootstrapTable("selectPage", 1);
        });

        // 代理商查询按钮点击事件
        $("#merchant-edit-modal .sb-agent-check-btn").on("click", function () {
            $("#editTable").bootstrapTable("selectPage", 1);
        });

        // 代理商模态框中查询数据清空
        $("#merchant-edit-modal").on('hide.bs.modal', function () {
            $("#merchant-edit-modal input[name='agentNo']").val("");
            $("#merchant-edit-modal input[name='name']").val("");
            $("#merchant-edit-modal").bootstrapTable("selectPage", 1);
        });

        // 代理商确认按钮点击事件
        $("#merchant-edit-modal .confirm-btn").on("click", function () {
            var agent = $("#editTable").bootstrapTable('getSelections');
            if (agent.length > 0) {
                agent = agent[0];
                $customerUpdateForm.find("input[id='agentName']").val(agent.name);
                $customerUpdateForm.find("input[id='agentId']").val(agent.agentNo);
                $customerUpdateForm.find("input[name='boCustomer.topAgentId']").val(agent.topAgentId);
                $customerUpdateForm.find("input[name='boCustomer.topAgentName']").val(agent.topAgentName);
            }
            $("#merchant-edit-modal").modal("hide");
        });


        //银行支行模态窗
        // 银行支行模态框中的数据清空-初始化

        $("#bank-edit-modal").on('show.bs.modal', function () {
            function merchantUpdateBankBean(argms) {
                argms.bankcode = $("#customer-update-form #merchantUpdateBankId  option:selected").data('shortcode');
                argms.branchbankcode = $("#bank-edit-modal input[name='branchbankcode']").val() || "";
                argms.branchbankname = $("#bank-edit-modal input[name='branchbankname']").val() || "";
                return argms;
            };

            $("#editbandTable").bootstrapTable("selectPage", 1);
        });


        //银行模态窗口
        $("#bank-edit-modal").on('hide.bs.modal', function () {
            $("#bank-edit-modal input[name='branchbankcode']").val("");
            $("#bank-edit-modal input[name='branchbankname']").val("");
            $("#editbandTable").bootstrapTable("selectPage", 1);
        });
        // 银行支行查询按钮点击事件
        $("#bank-edit-modal .btn-query").on("click", function () {
            $("#editbandTable").bootstrapTable("selectPage", 1);
        });
        //银行支行模态框中查询数据清空
        $("#bank-edit-modal").on('hide.bs.modal', function () {
            $("#bank-edit-modal input[name='branchbankcode']").val("");
            $("#bank-edit-modal input[name='branchbankname']").val("");
            $("#bank-edit-modal").bootstrapTable("selectPage", 1);
        });
        // 银行支行确认按钮点击事件
        $("#bank-edit-modal .btn-shxg-sure").on("click", function () {
            var manufacturer = $("#editbandTable").bootstrapTable('getSelections');
            $customerUpdateForm.data('formValidation').updateStatus('customer.branchbankName', 'NOT_VALIDATED', null);
            if (manufacturer.length > 0) {
                manufacturer = manufacturer[0];
                $customerUpdateForm.find("input[id='merchantUpdateBranchbankId']").val(manufacturer.branchbankcode);
                $customerUpdateForm.find("input[id='merchantUpdateBranchbankName']").val(manufacturer.branchbankname);
            }
            $("#bank-edit-modal").modal("hide");
        });


        //手机设备新增模态窗事件

        $("#device-edit-modal .btn-query").on("click", function (e) {
            e.preventDefault();
            $("#cusEditDeviceAddTable").bootstrapTable("selectPage", 1);
        });

        $("#device-edit-modal").on('hide.bs.modal', function () {
            $("#device-edit-modal input[name='bodyNoStart']").val("");
            $("#cusEditDeviceAddTable").bootstrapTable("selectPage", 1);
        });

        $("#device-edit-modal .confirm-btn").on("click", function () {
            var manufacturer = $("#cusEditDeviceAddTable").bootstrapTable('getSelections');
            if (manufacturer.length > 0) {
                manufacturer = manufacturer[0];

                var deviceNo = manufacturer.deviceNo;
                var isFirst = $("#device-edit-modal #isFirst").val();
                var typeName = manufacturer.typeName;
                var modeName = manufacturer.modeName;

                //发送新增设备请求
                var deviceBean = {
                    "customerId": up_mercNo,
                    "deviceNo": deviceNo,
                    "typeName": typeName,
                    "modeName": modeName,
                    "isFirst": isFirst

                };

                $.ajax({
                    type: "post",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/customer/insert.json",
                    data: JSON.stringify(deviceBean),
                    success: function (res) {
                        if (res != null) {
                            //页面手机商户设备表刷新table
                            $('#edit-device-list').bootstrapTable('refresh', {silent: true});
                            $("#cusEditDeviceAddTable").bootstrapTable("selectPage", 1);
                            // UTIL.clickDisappearSwal("新增成功！");
                        } else {
                            UTIL.clickDisappearSwal("新增失败！");
                        }
                    }
                });
            }
            $("#device-edit-modal").modal("hide");
        });


        $("#customer-update-form #merType").change(function () {
            merTypeVal = $("#customer-update-form #merType").val();

            if (merTypeVal == 1) {
                $('.hideLoop').hide();
                $('#customer-update-form .hideLoop').find("input").prop("disabled", true);
                $('#customer-update-form .hideLoop').find("select").prop("disabled", true);
                $('#customer-update-form #register-province').prop("disabled", false);
                $('#customer-update-form #register-city').prop("disabled", false);
                $(".addClearfix").addClass("clearfix");

            } else if (merTypeVal == 3) {
                $('.hideLoop').show();
                $('#customer-update-form #register-province').prop("disabled", false);
                $('#customer-update-form #register-city').prop("disabled", false);
                $('#customer-update-form .hideLoop').find("input").prop("disabled", false);
                $('#customer-update-form .hideLoop').find("select").prop("disabled", false);
                $(".addClearfix").removeClass("clearfix");
            }
        });

        $(".del-device-btn").on("click", function () {
            var del_device_list = $("#edit-device-list").bootstrapTable(
                    "getSelections");

            var del_list_length = del_device_list.length;
            if (del_list_length < 1) {
                UTIL.clickDisappearSwal("没有选中所要删除的设备");

            } else {
                $("#device-delete-edit-madal").modal("show");
            }
        });


        // 批量删除设备
        $("#device-confirm_btn").click(
            function () {
                var deviceArray = [];
                var del_device_list = $("#edit-device-list").bootstrapTable(
                        "getSelections");

                for (var i in del_device_list) {
                    deviceArray.push(del_device_list[i].deviceNo);
                }

                //发送删除请请求
                $.ajax({
                    type: "post",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/customer/batchDelete/" + up_mercNo + ".json",
                    data: JSON.stringify(deviceArray),
                    success: function (res) {
                        if (res > 0) {
                            //重新加载设备列表
                            $('#edit-device-list').bootstrapTable('refresh', {silent: true});
                            $("#cusEditDeviceAddTable").bootstrapTable("selectPage", 1);
                            $("#device-delete-edit-madal").modal("hide");
                            UTIL.clickDisappearSwal("删除成功！");
                        } else {
                            UTIL.clickDisappearSwal("删除失败！");
                        }

                    }
                });

            });

        //表单验证并提交
        $('#customer-update-form').formValidation({
            message: '此值无效', //此值无效
            excluded: ["#paramsYybName", "#directorUserName", "#ywzgName", ":disabled"],
            icon: {
                valid: 'glyphicon',
                invalid: 'glyphicon'
            },
            fields: {
                //代理商编号
                // "customer.agentId" : {
                //     group: '.form-group',
                //     validators : {
                //         notEmpty : {
                //             message : '代理商编号不能为空！'
                //         }
                //     }
                // },
                //代理商名称
                "customer.agentName": {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '代理商名称不能为空！'
                        }
                    }
                },
                //商户名称
                "customer.mercName": {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '商户名称不能为空！'
                        },
                        stringLength: {
                            min: 1,
                            max: 200,
                            message: '请输入200以内的字符！'
                        }
                    }
                },
                //商户手机
                'customer.mobile': {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '商户手机号不能为空！'
                        },
                        regexp: {
                            regexp: /^1[34578]\d{9}$/,
                            message: '请填写11位正确的手机号码！'
                        },
                        callback: {
                            message: '商户手机号已存在！',
                            callback: function (value, validator) {
                                // console.log(validator);
                                var reg = /^1[34578]\d{9}$/;
                                var flag = "";
                                if (reg.test(value)) {
                                    $.ajax({
                                        url: "/customer/updatebymobile/" + value+"/"+up_mercNo,
                                        type: "get",
                                        dataType:"text",
                                        async: false,
                                        success: function (res) {
                                            flag = res;
                                        }
                                    })
                                    if (flag == "手机号码与原先相同") {
                                        return true;
                                    }
                                    else {
                                        return false;
                                    }
                                }
                                else {
                                    return true;
                                }
                            }
                        }
                    }
                },
                //法人姓名
                'customer.legalName': {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '法人姓名不能为空！'
                        },
                        stringLength: {
                            min: 1,
                            max: 20,
                            message: '请输入20以内的字符！'
                        },
                       callback: {
                            callback: function (value, validator) {
                                $("#regaccountNameUpdate").val(value);
                                return  true;
                            }
                        } 
                    }
                },
                //身份证号码
                'customer.idCard': {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '身份证号码不能为空！'
                        },
                        regexp: {
                            regexp: /^[1-9]{1}[0-9]{14}$|^[1-9]{1}[0-9]{16}([0-9]|[xX])$/,
                            message: '请输入15或18位正确的身份证号码！'
                        }
                    }
                },
                //商户注册地址
                'customer.address': {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '输入不能为空！'
                        }
                    }
                },
                //许可经营范围
                'customer.scobus': {
                    group: '.form-group',
                    validators: {
                    	stringLength: {
                            min: 0,
                            max: 400,
                            message: "请输入400以内的字符！"

                        }
                    }
                },
              //申请设备
                'customer.description': {
                    group: '.form-group',
                    validators: {
                    	stringLength: {
                            min: 0,
                            max: 200,
                            message: "请输入200以内的字符！"

                        }
                    }
                },
/*                 //开户名
                'customer.accountName': {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '开户名不能为空！'
                        },
                        regexp: {
                            regexp: /^[\u4E00-\u9FFF]{1,20}$/,
                            message: '请填写1-20位汉字'
                        }
/*                         callback: {
                            message: '开户名须和法人姓名一致！',
                            callback: function (value, validator) {
                                // console.log(validator);
                               var legalName =  $("#reglegalNameUpdate").val();
                               if(legalName!==""){
                            	   if (value) {
                                   	if(legalName==value){
                                   		return true;
                                   	}else{
                                   		return false;
                                   	}
                                   }
                                   else {
                                       return true;
                                   }
                               }else{
                            	   return true;
                               }
                            }
                        } 
                    }
                }, */
                //开户主账号
                'customer.accountNo': {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '开户主账号不能为空！'
                        },
                        regexp: {
                            regexp: /^\d{16,19}$/,
                            message: '请输入为16至19位数字'
                        }
                    }
                },
                //开户总行名称
                'customer.bankId': {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '开户总行名称不能为空！'
                        }
                    }
                },
                //开户支行名称
                'customer.branchbankName': {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '开户支行名称不能为空！'
                        }
                    }
                },

                //联系手机
                'customer.merlinkmobile': {
                    group: '.form-group',
                    validators: {
                        regexp: {
                            regexp: /^1[34578]\d{9}$/,
                            message: '请填写11位正确的手机号码！'
                        }
                    }
                },
                //业务联系人姓名
                'customer.merlinkman': {
                    group: '.form-group',
                    validators: {
                        stringLength: {
                            min: 0,
                            max: 20,
                            message: "请输入20以内的字符！"

                        }
                    }
                },
                //业务联系人邮箱
                'customer.email': {
                    group: '.form-group',
                    validators: {
                        regexp: {
                            regexp: /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,
                            message: '请填写正确格式的邮箱！'
                        },
                        stringLength: {
                            min: 0,
                            max: 50,
                            message: "请输入50以内的字符！"

                        }
                    }
                },
                //业务联系人qq
                'customer.qq': {
                    group: '.form-group',
                    validators: {
                        regexp: {
                            regexp: /^\d{0,20}$/,
                            message: '请输入20以内数字！'
                        }
                    }
                },
                //借记卡扣率
                'customer.feeRate': {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '借记卡扣率不能为空！'
                        },
                        regexp: {
                            regexp: /^([1-9]\d|[0-9])(\.\d{1,2})?$/,
                            message: '正确格式12.12或12.3！'
                        }
                    }
                },
                //单笔手续费
                'customer.singleFee': {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '单笔手续费不能为空！'
                        },
                        regexp: {
                            regexp: /^([1-9]\d{0,8}|[0-9])(\.\d{1,2})?$/,
                            message: '正确格式12.12或12.3！'
                        }
                    }
                },
                //贷记卡扣率
                'customer.dfeeRate': {
                    group: '.form-group',
                    validators: {
                        notEmpty: {
                            message: '贷记卡扣率不能为空！'
                        },
                        regexp: {
                            regexp: /^([1-9]\d|[0-9])(\.\d{1,2})?$/,
                            message: '正确格式12.12或12.3！'
                        }
                    }
                },
                'customer.note':{
                	 group: '.form-group',
                     validators: {
                     	 stringLength: {
                              min: 0,
                              max: 200,
                              message: "请输入200以内的字符！"

                          }
                     }
                }
            }
        }).on('success.form.fv', function (e, data) {
            e.preventDefault();
            
            //判断oss是否上传
            // var lpPhoto = $('input[name="imgs[0].url"]').val();
            // var lpCardIdProsphoto = $('input[name="imgs[1].url"]').val();
            // var lpCardIdConsPhoto = $('input[name="imgs[2].url"]').val();
            // var bankPhoto = $('input[name="imgs[3].url"]').val();

            // if (lpPhoto == null || lpPhoto == '' || lpPhoto == 'undefined') {
            //     UTIL.clickDisappearSwal("请上传法人图片", function () {
            //         $("#customer_update_confirm_btn").removeClass('disabled').prop("disabled", false);
            //     });
            //     return;
            // }
            // if (lpCardIdProsphoto == null || lpCardIdProsphoto == '' || lpCardIdProsphoto == 'undefined') {
            //     UTIL.clickDisappearSwal("请上传法人身份证正面图片", function () {
            //         $("#customer_update_confirm_btn").removeClass('disabled').prop("disabled", false);
            //     });
            //     return;
            // }
            // if (lpCardIdConsPhoto == null || lpCardIdConsPhoto == '' || lpCardIdConsPhoto == 'undefined') {
            //     UTIL.clickDisappearSwal("请上传法人身份证反面图片", function () {
            //         $("#customer_update_confirm_btn").removeClass('disabled').prop("disabled", false);
            //     });
            //     return;
            // }
            // if (bankPhoto == null || bankPhoto == '' || bankPhoto == 'undefined') {
            //     UTIL.clickDisappearSwal("请上传银行卡照片图片", function () {
            //         $("#customer_update_confirm_btn").removeClass('disabled').prop("disabled", false);
            //     });
            //     return;
            // }
			showLoading();
            UTIL.submitForm({ //customer-update-form
                form: "#customer-update-form",
                url: "/customer/update.json",
                success: function () {
                    hideLoading();
                    // 商户信息更新成功之后刷新商户查询table
                    if ($("#custom-list")) {
                        $("#custom-list").bootstrapTable("selectPage", 1);
                    }
                    //提示成功添加代理商
                    UTIL.autoDisappearSwal("商户信息修改成功!", function () {
                        UTIL.closeCurrentPage({
                            delUrl: "merchant-update-apply.html",
                            toUrl: "merchant-query.html"
                        });
                    });
                }
            })
                });
        //初审取消按钮
        $("#customer_update_cancel_btn").click(function () {
            UTIL.closeCurrentPage({
                "delUrl": "merchant-update-apply.html",
                "toUrl": "bussinss-manage.html"
            })
        });


    });
</script>
